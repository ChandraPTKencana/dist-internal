import{_ as V}from"./Header.cca1e452.js";import{_ as j}from"./Plus.0d48322c.js";import{_ as E}from"./Edit.e31c6ac9.js";import{_ as q}from"./Search.0b0b0847.js";import{h as K,k as O,r as _,i as U,y as A,z as Y,c as f,b as g,a as e,m as k,v as Z,n as a,A as G,B as S,F as J,C as Q,l as W,o as p,D as X,t as u,E as ee,q as y,s as M,x as N}from"./entry.bd9ce3f6.js";import"./_plugin-vue_export-helper.c27b6911.js";const te={class:"w-full h-full flex flex-col"},oe={class:"w-full flex grow flex-col overflow-auto h-0"},le={class:"w-full flex"},se={class:"w-full flex p-1"},ae={class:"grow"},ne=e("div",{class:"font-bold"}," Keyword ",-1),re={class:"pl-1"},ue=e("div",{class:"font-bold"}," Sort By ",-1),ce=e("option",{value:""},null,-1),de=e("option",{value:"name"},"Name",-1),ie=e("option",{value:"contact_number"},"Contact Number",-1),_e=e("option",{value:"contact_person"},"Contact Person",-1),fe=[ce,de,ie,_e],pe={class:"pl-1"},me=e("div",{class:"font-bold"}," Sort Order ",-1),ve=e("option",{value:"asc"},"Asc",-1),he=e("option",{value:"desc"},"Desc",-1),be=[ve,he],ge={class:"flex items-end pl-1"},ye={class:"w-full flex justify-center items-center grow h-0 p-1"},ke={key:0,class:""},we={class:"tacky"},xe=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Name"),e("th",null,"Address"),e("th",null,"Contact Number"),e("th",null,"Contact Person"),e("th",null,"Marketer"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1),De=["onClick"],Ce={class:"bold"},Le={__name:"index",async setup($e){let m,w;const{$moment:x}=ee(),n={};n._TimeZoneOffset=new Date().getTimezoneOffset();const D=K("token"),{data:c}=([m,w]=O(async()=>W(async()=>{y().loading_full=!0;const{data:s,error:t,status:i}=await M("/api/institutes",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:n,retry:0},"$e1DlNBSFm7");return y().loading_full=!1,i.value==="error"?(N().trigger(t),[]):s.value.data},"$GkweZeKCBv")),m=await m,w(),m),r=_(""),d=_({field:"",by:"desc"}),v=_(-1),l=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),T=()=>{n.like="",r.value!=""&&(n.like=`id:%${r.value}%,name:%${r.value}%,address:%${r.value}%,contact_number:%${r.value}%,contact_person:%${r.value}%`),n.sort="",d.value.field&&(n.sort=d.value.field+":"+d.value.by)},h=_(null),C=async()=>{y().loading_full=!0,l.value.may_get_data=!1,n.page=l.value.page,n.page==1&&(c.value=[]);const{data:s,error:t,status:i}=await M("/api/institutes",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:n,retry:0},"$PoukrNx1Ih");if(y().loading_full=!1,l.value.may_get_data=!0,i.value==="error"){N().trigger(t);return}l.value.page==1?(c.value=s.value.data,h.value&&(h.value.scrollTop=0)):l.value.page>1&&(c.value=[...c.value,...s.value.data]),s.value.data.length==0&&(l.value.is_last_record=!0)},B=async()=>{if(!l.value.may_get_data)return;let s=h.value;if(s.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=s.scrollLeft;return}l.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(l.value.page++,await C())},H=()=>{l.value.page=1,l.value.is_last_record=!1,T(),C()},$=U(),L=()=>{$.push({name:"institute-form",query:{id:""}})},{display:z}=A();Y(A());const R=()=>{v.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):$.push({name:"institute-form",query:{id:c.value[v.value].id}})};return(s,t)=>{const i=V,F=j,I=E,P=q;return p(),f("div",te,[g(i,{title:"List Institute"}),e("div",oe,[e("div",le,[e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[0]||(t[0]=o=>L())},[g(F)]),e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[1]||(t[1]=o=>R())},[g(I)])]),e("div",se,[e("div",ae,[ne,k(e("input",{class:"w-full border-black border-solid border-2 p-1",type:"text","onUpdate:modelValue":t[2]||(t[2]=o=>G(r)?r.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[Z,a(r)]])]),e("div",re,[ue,k(e("select",{class:"w-full border-black border-solid border-2 p-1","onUpdate:modelValue":t[3]||(t[3]=o=>a(d).field=o)},fe,512),[[S,a(d).field]])]),e("div",pe,[me,k(e("select",{class:"w-full border-black border-solid border-2 p-1","onUpdate:modelValue":t[4]||(t[4]=o=>a(d).by=o)},be,512),[[S,a(d).by]])]),e("div",ge,[e("button",{class:"w-full border-black border-solid border-2 p-1",type:"button",name:"button",onClick:t[5]||(t[5]=o=>H())},[g(P,{class:"text-2xl"})])])]),e("div",ye,[a(c).length==0?(p(),f("div",ke," Maaf Tidak Ada Record ")):(p(),f("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:h,onScroll:B},[e("table",we,[xe,e("tbody",null,[(p(!0),f(J,null,Q(a(c),(o,b)=>(p(),f("tr",{key:b,onClick:Ae=>v.value=b,class:X(a(v)==b?"active":"")},[e("td",null,u(b+1)+".",1),e("td",Ce,u(o.name),1),e("td",null,u(o.address),1),e("td",null,u(o.contact_number),1),e("td",null,u(o.contact_person),1),e("td",null,u(o.internal_marketer.email),1),e("td",null,u(a(x)(o.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(a(x)(o.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,De))),128))])])],544))])])])}}};export{Le as default};
