import{_ as te}from"./Header.1b09f94f.js";import{_ as oe}from"./Plus.924cd5a1.js";import{_ as se}from"./Edit.f15b0909.js";import{_ as le}from"./Delete.f11290d1.js";import{_ as ae}from"./Search.0b36bd3c.js";import{_ as ne}from"./PopupMini.vue.03833ce0.js";import{_ as re}from"./Times.b5ba5fac.js";import{n as ue,o as _,c as f,a as e,b as d,O as j,q as ie,x as ce,r as c,s as de,E as F,F as _e,z as B,A as fe,B as l,G as pe,H,N as me,I as ve,J as he,y as ye,C as g,D as M,K as ge,t as u,L as be}from"./entry.99c205a0.js";import{u as xe}from"./useUtils.100f5b4a.js";import{u as T}from"./useMyFetch.980122cb.js";import"./_plugin-vue_export-helper.c27b6911.js";const we={key:0,class:"flex items-center justify-center fixed top-0 left-0 z-10 p-3 w-full h-full bg-black bg-opacity-80"},ke={class:"flex items-center max-w-xs w-full relative bg-white border-solid border-gray-600 border-2 p-3 flex-col flex-wrap"},Ce={class:"absolute -top-7 right-0 py-1 px-2 bg-white border-solid border-2 border-gray-600 border-b-0 rounded-tl-md"},$e={key:0,class:"mx-0 my-2 text-justify"},De=["src"],Ae={class:"flex w-full justify-between mt-5"},Se=ue({__name:"PopupSingleImage",props:{show:{type:Boolean,required:!0},photo:{type:String,required:!1,default:""},fnClose:{type:Function,required:!0}},setup(y){return(b,p)=>{const w=re;return y.show?(_(),f("div",we,[e("div",ke,[e("div",Ce,[d(w,{class:"text-2xl text-black cursor-pointer",onClick:p[0]||(p[0]=$=>y.fnClose())})]),y.photo?(_(),f("div",$e,[e("img",{src:y.photo,alt:"",class:"max-w-full max-h-full"},null,8,De)])):j("",!0),e("div",Ae,[e("button",{onClick:p[1]||(p[1]=$=>y.fnClose()),class:"w-full bg-blue-500 border-blue-500 border-solid border-2 p-1 text-white mr-2"}," Tutup ")])])])):j("",!0)}}}),Be={class:"w-full h-full flex flex-col"},Me={class:"w-full flex grow flex-col overflow-auto h-0"},Te={class:"w-full flex"},je={action:"#",class:"w-full flex p-1"},Ie={class:"grow"},Ne=e("div",{class:"font-bold"}," Keyword ",-1),Le={class:"pl-1"},ze=e("div",{class:"font-bold"}," Sort By ",-1),Ee=e("option",{value:"created_at"},"Created At",-1),Fe=e("option",{value:"name"},"Name",-1),He=e("option",{value:"value"},"Value",-1),Ve=[Ee,Fe,He],Ue={class:"pl-1"},qe=e("div",{class:"font-bold"}," Sort Order ",-1),Pe=e("option",{value:"asc"},"Asc",-1),Re=e("option",{value:"desc"},"Desc",-1),Oe=[Pe,Re],Ke={class:"flex items-end pl-1"},Je={class:"w-full flex justify-center items-center grow h-0 p-1"},Ye={key:0,class:""},Ge={class:"tacky"},Ze=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Unit"),e("th",null,"Value"),e("th",null,"Note"),e("th",null,"Created At"),e("th",null,"Created By"),e("th",null,"Updated At"),e("th",null,"Updated By")])],-1),Qe=["onClick"],We={class:"bold"},Xe={class:"p-0"},et=["onClick"],tt=["src"],ft={__name:"index",async setup(y){let b,p;const{$moment:w}=be(),{pointFormat:$}=xe(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="created_at:desc";const D=ie("token"),{data:r}=([b,p]=ce(async()=>ye(async()=>{g().loading_full=!0;const{data:s,error:o,status:h}=await T("/api/items",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:a,retry:0});return g().loading_full=!1,h.value==="error"?(M().trigger(o),[]):s.value.data},"$hEoAojBvbD")),b=await b,p(),b),m=c(""),v=c({field:"created_at",by:"desc"}),i=c(-1),n=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),V=()=>{a.like="",m.value!=""&&(a.like=`id:%${m.value}%,name:%${m.value}%,value:%${m.value}%`),a.sort="",v.value.field&&(a.sort=v.value.field+":"+v.value.by)},k=c(null),I=async()=>{g().loading_full=!0,n.value.may_get_data=!1,a.page=n.value.page,a.page==1&&(r.value=[]),a.first_row&&delete a.first_row,a.page>1&&(a.first_row=JSON.stringify(r.value[0]));const{data:s,error:o,status:h}=await T("/api/items",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:a,retry:0});if(g().loading_full=!1,n.value.may_get_data=!0,h.value==="error"){M().trigger(o);return}n.value.page==1?(r.value=s.value.data,k.value&&(k.value.scrollTop=0)):n.value.page>1&&(r.value=[...r.value,...s.value.data]),s.value.data.length==0&&(n.value.is_last_record=!0)},U=async()=>{if(!n.value.may_get_data)return;let s=k.value;if(s.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=s.scrollLeft;return}n.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(n.value.page++,await I())},q=()=>{n.value.page=1,n.value.is_last_record=!1,V(),I()},N=de(),P=()=>{N.push({name:"data_item-form",query:{id:""}})},{display:L}=F();_e(F());const R=()=>{i.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):N.push({name:"data_item-form",query:{id:r.value[i.value].id}})},z=c({}),x=c(!1),O=async()=>{x.value&&(x.value=!1)},K=()=>{i.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value={id:r.value[i.value].id},x.value=!0)},J=async()=>{g().loading_full=!0;const s=new FormData;s.append("id",r.value[i.value].id),s.append("_method","DELETE");const{data:o,error:h,status:S}=await T("/api/item",{method:"post",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:s,retry:0});if(g().loading_full=!1,S.value==="error"){M().trigger(h);return}r.value.splice(i.value,1),i.value=-1,x.value=!1},A=c(!1),E=c(""),Y=s=>{A.value=!0,E.value=s};return(s,o)=>{const h=te,S=oe,G=se,Z=le,Q=ae,W=ne,X=Se;return _(),f("div",Be,[d(h,{title:"List Item"}),e("div",Me,[e("div",Te,[e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[0]||(o[0]=t=>P())},[d(S)]),e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[1]||(o[1]=t=>R())},[d(G)]),e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[2]||(o[2]=t=>K())},[d(Z)])]),e("form",je,[e("div",Ie,[Ne,B(e("input",{class:"",type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>pe(m)?m.value=t:null),name:"search",placeholder:"Keyword"},null,512),[[fe,l(m)]])]),e("div",Le,[ze,B(e("select",{class:"","onUpdate:modelValue":o[4]||(o[4]=t=>l(v).field=t)},Ve,512),[[H,l(v).field]])]),e("div",Ue,[qe,B(e("select",{class:"","onUpdate:modelValue":o[5]||(o[5]=t=>l(v).by=t)},Oe,512),[[H,l(v).by]])]),e("div",Ke,[e("button",{class:"",type:"submit",name:"button",onClick:o[6]||(o[6]=me(t=>q(),["prevent"]))},[d(Q,{class:"text-2xl"})])])]),e("div",Je,[l(r).length==0?(_(),f("div",Ye," Maaf Tidak Ada Record ")):(_(),f("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:U},[e("table",Ge,[Ze,e("tbody",null,[(_(!0),f(ve,null,he(l(r),(t,C)=>(_(),f("tr",{key:C,onClick:ee=>i.value=C,class:ge(l(i)==C?"active":"")},[e("td",null,u(C+1)+".",1),e("td",We,u(t.id),1),e("td",Xe,[t.photo?(_(),f("div",{key:0,class:"absolute w-full h-full flex items-center justify-center cursor-pointer",onClick:ee=>Y(t.photo)},[e("img",{src:t.photo||"/stok/user-default.png",alt:"",class:"max-w-full max-h-full"},null,8,tt)],8,et)):j("",!0)]),e("td",null,u(t.name),1),e("td",null,u(t.unit.name),1),e("td",null,u(l($)(t.value)),1),e("td",null,u(t.note),1),e("td",null,u(l(w)(t.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(t.creator.username),1),e("td",null,u(l(w)(t.updated_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(t.updator.username),1)],10,Qe))),128))])])],544))])]),d(W,{type:"delete",show:l(x),data:l(z),fnClose:O,fnConfirm:J},null,8,["show","data"]),d(X,{show:l(A),photo:l(E),fnClose:()=>{A.value=!1}},null,8,["show","photo","fnClose"])])}}};export{ft as default};
