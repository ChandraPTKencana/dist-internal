import{_ as E}from"./HeaderPopup.vue.fe14bc58.js";import{_ as H}from"./PopupMini.vue.740d533e.js";import{r as u,g as Q,i as U,f as W,o as l,c as i,k as G,J,a as e,b as A,l as t,t as o,n as f,E as k,F as D,D as K,C as L,w as R,d as B,G as X,x as y,y as M,p as Z,e as ee}from"./entry.468c1924.js";import{u as te}from"./useUtils.f67a7b52.js";import{u as V}from"./useMyFetch.5d39e20e.js";import{_ as se}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.725e6b46.js";import"./Exclamation.b8184944.js";const a=r=>(Z("data-v-0e01ed61"),r=r(),ee(),r),oe={class:"box-fixed"},ae={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},le={class:"w-full flex flex-col items-center grow overflow-auto"},ie={class:"w-full flex flex-row flex-wrap"},ne={key:0,class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},re=a(()=>e("label",{for:""},"Confirm At",-1)),ce={class:"card-border"},de={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},_e=a(()=>e("label",{for:""},"Tipe",-1)),ue={class:"card-border"},fe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},me=a(()=>e("label",{for:""},"From Warehouse",-1)),we={key:0,class:"w-full flex",style:{}},pe={class:"flex flex-row flex-wrap grow"},he={class:"p-1"},xe=a(()=>e("div",{class:"text-sm text-gray-600"},"ID",-1)),ve={class:"bold"},ye={class:"p-1"},be=a(()=>e("div",{class:"text-sm text-gray-600"},"Name",-1)),ge={class:"bold"},ke={class:"flex flex-row flex-wrap grow"},De={class:"p-1"},Ce=a(()=>e("div",{class:"text-sm text-gray-600"},"ID",-1)),Ne={class:"bold"},Ie={class:"p-1"},je=a(()=>e("div",{class:"text-sm text-gray-600"},"Name",-1)),Fe={class:"bold"},Se={key:1,class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},qe=a(()=>e("label",{for:""},"To Warehouse",-1)),Ae={class:"w-full flex",style:{}},Be={class:"flex flex-row flex-wrap grow"},Me={class:"p-1"},Ve=a(()=>e("div",{class:"text-sm text-gray-600"},"ID",-1)),$e={class:"bold"},Te={class:"p-1"},ze=a(()=>e("div",{class:"text-sm text-gray-600"},"Name",-1)),Oe={class:"bold"},Ye={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Pe=a(()=>e("label",{for:""},"Note",-1)),Ee={class:"card-border"},He={class:"w-full flex grow p-1 justify-between flex-wrap"},Qe={class:"w-full",role:"sticky"},Ue={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},We=a(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail ")]),e("tr",{class:"sticky top-8 !z-[2]"},[e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No"),e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"ID Item"),e("th",null,"Nama Item"),e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"Qty In"),e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"Qty Out"),e("th",null,"Keterangan")])],-1)),Ge={ref:"to_move"},Je=["data-index"],Ke={class:"cell"},Le={class:"w-full h-auto flex items-center justify-center"},Re={class:"cell"},Xe={class:"w-full h-auto flex items-center justify-center"},Ze={class:"cell"},et={class:"w-full h-auto flex items-center justify-center"},tt={class:"cell"},st={class:"w-full h-auto flex items-center justify-center"},ot={class:"cell"},at={class:"w-full flex items-center justify-end"},lt={class:"w-full flex flex-wrap p-3 items-center"},it=a(()=>e("div",null," Di Validasi oleh : ",-1)),nt={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},rt={key:0},ct=a(()=>e("b",null,"tidak dapat dikembalikan lagi",-1)),dt={__name:"transaction_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(r){const _=r,{$moment:C}=X(),{pointFormat:N}=te();let b={id:"",name:""};const $={id:-1,type:"used",note:"",warehouse:{...b},warehouse_source:{...b},warehouse_target:{...b},details:[],confirmed_by:{username:""},confirmed_at:""},s=u({...$}),I=Q("token"),j=u({}),F=u(null),S=u([]),T=async()=>{y().loading_full=!0,j.value={};const c=new FormData;let d="post",m=_.id;m==0||(c.append("id",m),c.append("_method","PUT"));const{data:p,error:n,status:h}=await V("/api/confirm_transaction",{method:d,headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},body:c,retry:0});if(y().loading_full=!1,h.value==="error"){M().trigger(n,j);return}s.value.confirmed_user=p.value.confirmed_user,s.value.confirmed_by=p.value.confirmed_by,s.value.confirmed_at=p.value.confirmed_at;let x=_.p_data.map(v=>v.id).indexOf(_.id);x>=-1&&_.p_data.splice(x,1,{...s.value}),w.value=!1,_.fnClose()},z=async()=>{y().loading_full=!0;const{data:c,error:d,status:m}=await V("/api/transaction",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:{id:_.id},retry:0});if(y().loading_full=!1,m.value==="error"){M().trigger(d);return}s.value=c.value.data,S.value=c.value.data.details};u({from:"",to:new Date});const O=u(!0),q=u({}),w=u(!1),Y=()=>{q.value={id:s.value.id,type:s.value.type,target:s.value.warehouse_target.name},w.value=!0},P=async()=>{w.value&&(w.value=!1)},g=U(()=>!1);return W(()=>_.show,(c,d)=>{c==!0&&(_.is_view==!1&&setTimeout(()=>{F.value.focus()},1),z())},{immediate:!0}),(c,d)=>{const m=E,p=H;return l(),i(D,null,[G(e("section",oe,[e("div",null,[A(m,{title:"Form Transaction Validation",fn:r.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ae,[e("div",le,[e("div",ie,[t(s).confirmed_user?(l(),i("div",ne,[re,e("div",ce,o(t(C)(t(s).confirmed_at).format("DD-MM-Y")),1)])):f("",!0),e("div",de,[_e,e("div",ue,o(t(s).type),1)]),e("div",fe,[me,e("div",{class:k(["w-full flex flex-row flex-wrap card-border",t(g)?"unselectable":""])},[t(s).ref_id==null?(l(),i("div",we,[e("div",pe,[e("div",he,[xe,e("div",ve,o(t(s).warehouse.id),1)]),e("div",ye,[be,e("div",ge,o(t(s).warehouse.name),1)])])])):t(s).ref_id!=null?(l(),i("div",{key:1,class:k(["w-full flex",t(g)?"unselectable":""]),style:{}},[e("div",ke,[e("div",De,[Ce,e("div",Ne,o(t(s).warehouse_source.id),1)]),e("div",Ie,[je,e("div",Fe,o(t(s).warehouse_source.name),1)])])],2)):f("",!0)],2)]),t(s).type=="transfer"?(l(),i("div",Se,[qe,e("div",{class:k(["w-full flex flex-row flex-wrap card-border",t(g)?"unselectable":""])},[e("div",Ae,[e("div",Be,[e("div",Me,[Ve,e("div",$e,o(t(s).warehouse_target.id),1)]),e("div",Te,[ze,e("div",Oe,o(t(s).warehouse_target.name),1)])])])],2)])):f("",!0),e("div",Ye,[Pe,e("div",Ee,o(t(s).note),1)])]),e("div",He,[e("div",Qe,[e("table",Ue,[We,e("tbody",Ge,[(l(!0),i(D,null,K(t(S),(n,h)=>{var x,v;return l(),i(D,{key:h},[n.p_status!="Remove"?(l(),i("tr",{key:0,"data-index":h},[e("td",null,o(h+1)+".",1),e("td",Ke,[e("div",Le,o((x=n.item)==null?void 0:x.id),1)]),e("td",Re,[e("div",Xe,o((v=n.item)==null?void 0:v.name),1)]),e("td",Ze,[e("div",et,o(t(N)(n.qty_in||0)),1)]),e("td",tt,[e("div",st,o(t(N)(n.qty_out||0)),1)]),e("td",ot,o(n.note),1)],8,Je)):f("",!0)],64)}),128))],512)])])])]),e("div",at,[e("div",lt,[it,t(s).confirmed_by?(l(),i("div",nt,[t(s).confirmed_by?(l(),i("div",rt," App 1 : "+o(t(s).confirmed_by.username)+" ( "+o(t(s).confirmed_at?t(C)(t(s).confirmed_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:d[0]||(d[0]=n=>r.fnClose())}," Cancel "),r.is_view==0?(l(),i("button",{key:0,ref_key:"it_val",ref:F,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:d[1]||(d[1]=L(n=>Y(),["prevent"]))}," Validasi ",512)):f("",!0)])])])],512),[[J,r.show]]),A(p,{type:"custome",show:t(w),data:t(q),fnClose:P,fnConfirm:T,enabledOk:t(O)},{words:R(()=>[B(" Data akan diproses dan "),ct,B(", yakin untuk melanjutkan ? ")]),_:1},8,["show","data","enabledOk"])],64)}}},vt=se(dt,[["__scopeId","data-v-0e01ed61"]]);export{vt as default};
