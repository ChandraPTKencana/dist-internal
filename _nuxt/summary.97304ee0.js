import X from"./Header.973bd304.js";import{_ as Y}from"./client-only.e285d0a8.js";import ee from"./Search.c49a73f1.js";import te from"./summary_detail.01b57aee.js";import{r as i,g as se,h as oe,i as N,I as ae,c as r,b as p,a as o,w as le,t as f,l,C as re,k as ne,A as ie,m as ce,F as g,D as k,q as ue,o as n,E as U,p as de,e as _e,x as b,y as j}from"./entry.cd89349b.js";import"./useUtils.ba8d89ba.js";import{u as F}from"./useMyFetch.b49701aa.js";import{_ as me}from"./_plugin-vue_export-helper.c27b6911.js";import"./HeaderPopup.vue.891fa2bd.js";import"./Times.d1edbe5a.js";const q=h=>(de("data-v-c8bf836b"),h=h(),_e(),h),pe={class:"w-full h-full flex flex-col"},fe={class:"w-full flex grow flex-col overflow-auto h-0"},he={action:"#",class:"w-full flex p-1"},ve={class:"w-full flex flex-row flex-wrap p-1 items-center"},ye=q(()=>o("label",{for:"",class:"pr-1"},"To",-1)),we={class:"grow"},xe={class:"text-red-500"},ge={class:"flex items-end p-1"},ke={class:"w-full flex"},be={class:"p-1"},Ce={class:"grow flex flex-row flex-wrap"},Se={class:"p-1"},De=["onClick"],Ie={class:"w-full flex justify-center items-center grow h-0 p-1"},Ae={key:0,class:""},$e={key:1,class:"w-full h-full overflow-auto",role:"sticky",ref:"loadRef"},ze={class:"tacky"},Re={class:"sticky top-0 !z-[5]"},Ve=q(()=>o("th",{class:"freeze"},"Item Name",-1)),Me=["onClick"],Oe={class:"font-bold !text-left"},Te=["onClick"],Be={__name:"summary",async setup(h){var B,E,H;let v,z;const u=i({from:"",to:new Date}),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const R=se("token"),{data:C}=([v,z]=oe(async()=>ue(async()=>{let e={all:[],column_header:[],row_header:[]};b().loading_full=!0,c.page=1,c.to=u.value.to;const{data:t,error:s,status:w}=await F("/api/summary_transactions",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:c,retry:0});return b().loading_full=!1,w.value==="error"?(j().trigger(s),{transactions:e}):(e=t.value,{transactions:e})},"$WHzS0UHVRu")),v=await v,z(),v),L=i({}),d=i(((B=C.value)==null?void 0:B.transactions.all)||[]),S=i(((E=C.value)==null?void 0:E.transactions.column_header)||[]),V=i(((H=C.value)==null?void 0:H.transactions.row_header)||[]),M=i(-1),D=i(!1),O=i({}),Q=async()=>{b().loading_full=!0,c.page=1,c.to=u.value.to,d.value=[];const{data:e,error:t,status:s}=await F("/api/summary_transactions",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:c,retry:0});if(b().loading_full=!1,s.value==="error"){j().trigger(t);return}d.value=e.value.all,S.value=e.value.column_header,V.value=e.value.row_header},W=(e,t)=>{let s=d.value.filter(m=>m.id==e)[0];const{items:w,...I}=s;let A=s.items.filter(m=>m.id==t)[0];return{rest:I,item:A}},Z=(e,t)=>d.value.filter(s=>s.id==e)[0].items.filter(s=>s.id==t)[0].qty_reminder,G=(e,t,s)=>{O.value=e,D.value=!0},y=i(""),_=i([]),J=e=>{let t=_.value.map(s=>s.id).indexOf(e.id);t==-1?_.value.push(e):_.value.splice(t,1)},K=e=>_.value.some(t=>t.id===e.id),T=N(()=>{let e=[],t=_.value.map(s=>s.id);return S.value.forEach(s=>{t.indexOf(s.id)==-1&&e.push(s)}),e}),P=N(()=>{let e=y.value;const t=new RegExp("("+e+")","i");return V.value.filter(s=>s.name.match(t))});return(e,t)=>{const s=X,w=ae("vue-date-picker"),I=Y,A=ee,m=te;return n(),r("div",pe,[p(s,{title:"Summary"}),o("div",fe,[o("form",he,[o("div",ve,[ye,o("div",we,[p(I,null,{default:le(()=>[p(w,{modelValue:l(u).to,"onUpdate:modelValue":t[0]||(t[0]=a=>l(u).to=a),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1})]),o("p",xe,f(l(L).to),1)]),o("div",ge,[o("button",{style:{width:"38px",height:"38px"},type:"submit",name:"button",onClick:t[1]||(t[1]=re(a=>Q(),["prevent"]))},[p(A,{class:"text-2xl"})])])]),o("div",ke,[o("div",be,[ne(o("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=a=>ce(y)?y.value=a:null),placeholder:"Item Name"},null,512),[[ie,l(y)]])]),o("div",Ce,[(n(!0),r(g,null,k(l(S),a=>(n(),r("div",Se,[o("div",{class:U(["p-1 rounded ring-1 ring-slate-500 cursor-pointer",K(a)?"bg-white text-black":"bg-slate-600 text-white"]),onClick:x=>J(a)},f(a.lokasi),11,De)]))),256))])]),o("div",Ie,[l(d).length==0?(n(),r("div",Ae," Maaf Tidak Ada Record ")):(n(),r("div",$e,[o("table",ze,[o("thead",Re,[o("tr",null,[Ve,(n(!0),r(g,null,k(l(T),a=>(n(),r("th",null,f(a.lokasi),1))),256))])]),o("tbody",null,[(n(!0),r(g,null,k(l(P),(a,x)=>(n(),r("tr",{key:x,onClick:$=>M.value=x,class:U(l(M)==x?"active":"")},[o("th",Oe,f(a.name),1),(n(!0),r(g,null,k(l(T),$=>(n(),r("td",null,[o("a",{class:"text-blue-500 font-bold underline cursor-pointer",onClick:Ee=>G(W($.id,a.id))},f(Z($.id,a.id)),9,Te)]))),256))],10,Me))),128))])])],512))])]),p(m,{show:l(D),data:l(O),filter_date:l(u),fnClose:()=>{D.value=!1}},null,8,["show","data","filter_date","fnClose"])])}}},Ge=me(Be,[["__scopeId","data-v-c8bf836b"]]);export{Ge as default};
