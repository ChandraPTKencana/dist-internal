import{_ as O}from"./HeaderCustom.vue.523f460b.js";import{_ as E}from"./InputPointFormat.vue.b27bb6cb.js";import{_ as K}from"./Search.078931d6.js";import{_ as P}from"./Delete.8cf306b7.js";import{_ as J}from"./HeaderPopup.vue.2ba2201a.js";import{q as L,r as h,g as Q,z as A,M as Y,o as $,c as b,a as e,b as k,G,A as j,B as t,H as V,N as z,I as F,J as Z,K as W,t as d,L as X,p as ee,e as te,C as D,D as q,n as se,u as oe,s as le,v as ae,x as ne,y as ie}from"./entry.67d5c412.js";import{u as re}from"./useUtils.100f5b4a.js";import{u as B}from"./useMyFetch.33ba659c.js";import{_ as ce}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.92e6393e.js";const y=w=>(ee("data-v-4a351037"),w=w(),te(),w),ue={class:"box-fixed"},de={action:"#",class:"w-full flex p-1"},_e={class:"grow"},fe=y(()=>e("div",{class:"font-bold"}," Keyword ",-1)),pe={class:"pl-1"},me=y(()=>e("div",{class:"font-bold"}," Sort By ",-1)),ve=y(()=>e("option",{value:"created_at"},"Created At",-1)),he=y(()=>e("option",{value:"id"},"ID",-1)),ye=y(()=>e("option",{value:"name"},"Nama",-1)),we=[ve,he,ye],xe={class:"pl-1"},ge=y(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),$e=y(()=>e("option",{value:"asc"},"Asc",-1)),be=y(()=>e("option",{value:"desc"},"Desc",-1)),ke=[$e,be],Se={class:"flex items-end pl-1"},Ce={class:"w-full flex justify-center items-center grow h-0 p-1"},Ae={key:0,class:""},De={class:"tacky"},Ue=y(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1)),Ie=["onClick"],Me={class:"bold"},Ne={class:"flex",style:{"justify-content":"end",padding:"5px"}},Te={__name:"units",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1}},setup(w){const x=w,{$moment:U}=X(),{countClickListFn:M}=re(),p=L("token"),_=h([]),m=h(""),f=h({field:"created_at",by:"desc"}),o=h(-1),l=h({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),i={};i._TimeZoneOffset=new Date().getTimezoneOffset();const T=()=>{i.like="",m.value!=""&&(i.like=`id:%${m.value}%,name:%${m.value}%`),i.sort="",f.value.field&&(i.sort=f.value.field+":"+f.value.by)},S=h(null),N=async()=>{D().loading_full=!0,l.value.may_get_data=!1,i.page=l.value.page,i.page==1&&(_.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(_.value[0]));const{data:n,error:a,status:c}=await B("/api/units",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:i,retry:0});if(D().loading_full=!1,l.value.may_get_data=!0,c.value==="error"){q().trigger(a);return}l.value.page==1?(_.value=n.value.data,S.value&&(S.value.scrollTop=0)):l.value.page>1&&(_.value=[..._.value,...n.value.data]),n.value.data.length==0&&(l.value.is_last_record=!0)},H=async()=>{if(!l.value.may_get_data)return;let n=S.value;if(n.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=n.scrollLeft;return}l.value.is_last_record||!(Math.round(n.scrollTop)+n.clientHeight>=n.scrollHeight-1)||(l.value.page++,await N())},r=()=>{l.value.page=1,l.value.is_last_record=!1,T(),N()},s=()=>{o.value>-1?x.fnSelect(_.value[o.value]):x.fnSelect({id:"",name:""})},v=h(null);let g=null;const C=n=>{g&&clearTimeout(g),g=setTimeout(()=>{r()},500)};return Q(()=>x.show,(n,a)=>{n==!0&&r(),setTimeout(()=>{v.value.focus()},100)},{immediate:!0}),(n,a)=>{const c=J,R=K;return A(($(),b("section",ue,[e("div",null,[k(c,{title:"Search And Select Unit",fn:w.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",de,[e("div",_e,[fe,A(e("input",{ref_key:"ref_keyword",ref:v,class:"",type:"text","onUpdate:modelValue":a[0]||(a[0]=u=>G(m)?m.value=u:null),name:"search",placeholder:"Keyword",onKeyup:a[1]||(a[1]=u=>C())},null,544),[[j,t(m)]])]),e("div",pe,[me,A(e("select",{class:"","onUpdate:modelValue":a[2]||(a[2]=u=>t(f).field=u)},we,512),[[V,t(f).field]])]),e("div",xe,[ge,A(e("select",{class:"","onUpdate:modelValue":a[3]||(a[3]=u=>t(f).by=u)},ke,512),[[V,t(f).by]])]),e("div",Se,[e("button",{class:"",type:"submit",name:"button",onClick:a[4]||(a[4]=z(u=>r(),["prevent"]))},[k(R,{class:"text-2xl"})])])]),e("div",Ce,[t(_).length==0?($(),b("div",Ae," Maaf Tidak Ada Record ")):($(),b("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:S,onScroll:H},[e("table",De,[Ue,e("tbody",null,[($(!0),b(F,null,Z(t(_),(u,I)=>($(),b("tr",{key:I,onClick:rt=>t(M)(I,()=>{o.value=I},s),class:W(t(o)==I?"active":"")},[e("td",null,d(I+1)+".",1),e("td",Me,d(u.id),1),e("td",null,d(u.name),1),e("td",null,d(t(U)(u.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,d(t(U)(u.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ie))),128))])])],544))]),e("div",Ne,[e("button",{onClick:a[5]||(a[5]=u=>s()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[Y,w.show]])}}},He=ce(Te,[["__scopeId","data-v-4a351037"]]),je={class:"w-full h-full flex flex-col"},qe={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Be={class:"w-full align-items-center justify-content-center grow overflow-auto"},Ve={class:"w-full flex flex-col flex-wrap p-1"},Ke=e("label",{for:""},"Name",-1),Le={class:"text-red-500"},ze={class:"w-full flex flex-col flex-wrap p-1"},Fe=e("label",{for:""},"Value",-1),Re={class:"text-red-500"},Oe={class:"w-full flex flex-col flex-wrap p-1"},Ee=e("label",{for:""},"Note",-1),Pe={class:"text-red-500"},Je={class:"w-full flex flex-col flex-wrap p-1"},Qe=e("label",{for:""},"Unit",-1),Ye={class:"card-border flex flex-row flex-wrap"},Ge={key:0,class:"w-full flex"},Ze=e("div",{class:"flex items-center grow p-1"}," Pilih Unit ",-1),We={key:1,class:"w-full flex",style:{}},Xe={class:"flex flex-row flex-wrap grow"},et={class:"p-1"},tt=e("div",{class:"text-sm text-gray-600"},"ID",-1),st={class:"bold"},ot={class:"p-1"},lt=e("div",{class:"text-sm text-gray-600"},"Email",-1),at={class:"bold"},nt={class:"text-red-500"},it={class:"w-full flex items-center justify-end"},wt=se({__name:"form",async setup(w){let x,U;oe();const M=L("token"),p=h({}),_=le(),m=ae();let f={id:"",name:""};const{data:o}=([x,U]=ne(async()=>ie(async()=>{const r=m.query.id;if(r!==void 0&&r!==""){D().loading_full=!0;const{data:s,error:v,status:g}=await B("/api/item",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{id:r},retry:0});if(D().loading_full=!1,g.value==="error")q().trigger(v,p);else return s.value.data}return{id:-1,name:"",value:0,note:"",unit:{...f}}},"$eQTKQHw4Kq")),x=await x,U(),x);let l=h(!1);const i=()=>{o.value.unit={...f}},T=()=>{l.value=!0},S=()=>{l.value=!1},N=r=>{o.value.unit=r,l.value=!1},H=async()=>{D().loading_full=!0,p.value={};let r={name:o.value.name,value:o.value.value,note:o.value.note,unit_id:o.value.unit.id},s="post",v=m.query.id;v===""||(s="put",r.id=v);const{data:g,error:C,status:n}=await B("/api/item",{method:s,headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:r,retry:0});if(D().loading_full=!1,n.value==="error"){q().trigger(C,p);return}_.go(-1)};return(r,s)=>{const v=O,g=E,C=K,n=P,a=He;return $(),b(F,null,[e("div",je,[k(v,{title:"Form Item",back:!0}),e("form",qe,[e("div",Be,[e("div",Ve,[Ke,A(e("input",{class:"",type:"text","onUpdate:modelValue":s[0]||(s[0]=c=>t(o).name=c)},null,512),[[j,t(o).name]]),e("p",Le,d(t(p).name),1)]),e("div",ze,[Fe,k(g,{class:"",type:"text",value:t(o).value,onInput:s[1]||(s[1]=c=>t(o).value=c)},null,8,["value"]),e("p",Re,d(t(p).value),1)]),e("div",Oe,[Ee,A(e("textarea",{class:"","onUpdate:modelValue":s[2]||(s[2]=c=>t(o).note=c)},null,512),[[j,t(o).note]]),e("p",Pe,d(t(p).note),1)]),e("div",Je,[Qe,e("div",Ye,[!t(o).unit||!t(o).unit.id?($(),b("div",Ge,[e("button",{type:"button",onClick:s[3]||(s[3]=c=>T()),class:"flex items-center grow"},[k(C,{class:"text-2xl text-black"}),Ze])])):($(),b("div",We,[e("div",Xe,[e("div",et,[tt,e("div",st,d(t(o).unit.id),1)]),e("div",ot,[lt,e("div",at,d(t(o).unit.name),1)])]),e("button",{type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:s[4]||(s[4]=c=>i())},[k(n,{class:"text-2xl text-white"})])]))]),e("p",nt,d(t(p).unit_id),1)])]),e("div",it,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[5]||(s[5]=c=>r.$router.go(-1))}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[6]||(s[6]=z(c=>H(),["prevent"]))}," Save ")])])]),k(a,{show:t(l),fnClose:S,fnSelect:N,excludes:"item_had_which_item_id"},null,8,["show"])],64)}}});export{wt as default};
