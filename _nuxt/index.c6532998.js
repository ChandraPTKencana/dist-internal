import{q as _e,x as de,y as me,C as _,D as S,r as d,s as fe,E as F,F as pe,o as f,c as v,a as e,b as p,B as s,S as j,O as ve,z as he,A as ye,G as ge,N as be,I as we,J as ke,K as xe,t as i,L as De,_ as w,$ as k,a0 as x}from"./entry.6adb1d9c.js";import{_ as Ce}from"./Plus.9690bdab.js";import{_ as Te}from"./Edit.ed37ea80.js";import{b as $e,_ as Ae,a as Ee}from"./Table2Column.7204c789.js";import{_ as Se}from"./Delete.fe98d890.js";import{_ as Ie}from"./Signature.9fd7a3c8.js";import{_ as Le}from"./Search.c6944c0d.js";import{_ as Re}from"./PopupMini.vue.3146ae97.js";import{u as I}from"./useMyFetch.f71c811d.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.ba69d818.js";const Me={class:"w-full h-full flex flex-col border-t-4 border-slate-600"},qe={class:"w-full flex grow flex-col overflow-auto h-0"},Be={class:"w-full flex"},Ne=["disabled"],Pe={class:"text-sm absolute top-0 right-0 flex justify-end"},Oe={key:0,class:"w-2 h-2 rounded-full bg-red-700 border-2 border-solid border-red-950"},Ve={action:"#",class:"w-full flex p-1"},ze={class:"grow"},Fe=e("div",{class:"font-bold"}," Keyword ",-1),je={class:"flex items-end pl-1"},He={class:"w-full flex justify-center items-center grow h-0 p-1"},Ke={key:0,class:""},We={class:"tacky"},Ye=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"ID"),e("th",null,"Input At"),e("th",null,"Warehouse Name"),e("th",null,"Note"),e("th",null,"Status"),e("th",null,"Type"),e("th",null,"Warehouse Source Name"),e("th",null,"Warehouse Target Name"),e("th",null,"Confirmed At"),e("th",null,"Confirmed By"),e("th",null,"Requested At"),e("th",null,"Requested By")])],-1),Je=["onClick"],Ue={class:"bold"},it={__name:"index",async setup(Ge){let g,L;const{$moment:D}=De(),r={};r._TimeZoneOffset=new Date().getTimezoneOffset();const C=_e("token"),{data:R}=([g,L]=de(async()=>me(async()=>{let o=[],t=null;_().loading_full=!0;const{data:m,error:y,status:A}=await I("/api/transactions",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:r,retry:0});return _().loading_full=!1,A.value==="error"?S().trigger(y):(o=m.value.data,t=m.value.request_notif),{transactions:o,request_notif:t}},"$wg4TTX8CpE")),g=await g,L(),g),n=d(R.value.transactions),H=d(R.value.request_notif),c=d(""),T=d({field:"updated_at",by:"desc"}),l=d(-1),u=d({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),K=()=>{r.like="",c.value!=""&&(r.like=`id:%${c.value}%,warehouse_name:%${c.value}%,warehouse_source_name:%${c.value}%,warehouse_target_name:%${c.value}%,item_name:%${c.value}%,status:%${c.value}%,type:%${c.value}%`),r.sort="",T.value.field&&(r.sort=T.value.field+":"+T.value.by)},b=d(null),M=async()=>{_().loading_full=!0,u.value.may_get_data=!1,r.page=u.value.page,r.page==1&&(n.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(n.value[0]));const{data:o,error:t,status:m}=await I("/api/transactions",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:r,retry:0});if(_().loading_full=!1,u.value.may_get_data=!0,m.value==="error"){S().trigger(t);return}u.value.page==1?(n.value=o.value.data,b.value&&(b.value.scrollTop=0)):u.value.page>1&&(n.value=[...n.value,...o.value.data]),o.value.data.length==0&&(u.value.is_last_record=!0)},W=async()=>{if(!u.value.may_get_data)return;let o=b.value;if(o.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=o.scrollLeft;return}u.value.is_last_record||!(Math.round(o.scrollTop)+o.clientHeight>=o.scrollHeight-1)||(u.value.page++,await M())},Y=()=>{u.value.page=1,u.value.is_last_record=!1,K(),M()};fe();const q=()=>w(k(()=>x(()=>import("./form.10d89547.js"),["./form.10d89547.js","./Search.c6944c0d.js","./_plugin-vue_export-helper.c27b6911.js","./entry.6adb1d9c.js","./entry.29f4d521.css","./Delete.fe98d890.js","./ToolsPopup.b4ded73b.js","./HeaderPopup.vue.d86417f2.js","./Times.ba69d818.js","./useUtils.100f5b4a.js","./useMyFetch.f71c811d.js","./ToolsPopup.6974ab63.css","./InputPointFormat.vue.585e0632.js","./Plus.9690bdab.js"],import.meta.url))),J=async()=>{await _().setDynamicComponent(q,"Tambah Transaksi",{id:null})},{display:$}=F();pe(F());const U=async()=>{l.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):await _().setDynamicComponent(q,"Ubah Transaksi",{id:n.value[l.value].id})},G=()=>w(k(()=>x(()=>import("./confirm.568dfb5d.js"),["./confirm.568dfb5d.js","./client-only.160ae1b4.js","./entry.6adb1d9c.js","./entry.29f4d521.css","./PopupMini.vue.3146ae97.js","./Times.ba69d818.js","./_plugin-vue_export-helper.c27b6911.js","./useMyFetch.f71c811d.js"],import.meta.url))),X=async()=>{l.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):await _().setDynamicComponent(G,"Konfirmasi Transaksi",{id:n.value[l.value].id})},Z=()=>w(k(()=>x(()=>import("./request.fbee8092.js"),["./request.fbee8092.js","./entry.6adb1d9c.js","./entry.29f4d521.css","./Signature.9fd7a3c8.js","./_plugin-vue_export-helper.c27b6911.js","./Search.c6944c0d.js","./useMyFetch.f71c811d.js"],import.meta.url))),Q=async()=>{await _().setDynamicComponent(Z,"List Transaksi")},ee=()=>w(k(()=>x(()=>import("./summary.dddfbd0e.js"),["./summary.dddfbd0e.js","./client-only.160ae1b4.js","./entry.6adb1d9c.js","./entry.29f4d521.css","./Search.c6944c0d.js","./_plugin-vue_export-helper.c27b6911.js","./summary_detail.daa65e22.js","./HeaderPopup.vue.d86417f2.js","./Times.ba69d818.js","./useUtils.100f5b4a.js","./useMyFetch.f71c811d.js","./summary_detail.72722d5b.css","./summary.3444f4e7.css"],import.meta.url))),te=async()=>{await _().setDynamicComponent(ee,"Summary Transaksi")},B=d({}),h=d(!1),ae=async()=>{h.value&&(h.value=!1)},se=()=>{l.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(B.value={id:n.value[l.value].id},h.value=!0)},oe=async()=>{_().loading_full=!0;const o=new FormData;o.append("id",n.value[l.value].id),o.append("_method","DELETE");const{data:t,error:m,status:y}=await I("/api/transaction",{method:"post",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:o,retry:0});if(_().loading_full=!1,y.value==="error"){S().trigger(m);return}n.value.splice(l.value,1),l.value=-1,h.value=!1};return(o,t)=>{const m=Ce,y=Te,A=$e,le=Se,ne=Ie,re=Ae,ue=Ee,ie=Le,ce=Re;return f(),v("div",Me,[e("div",qe,[e("div",Be,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=a=>J())},[p(m)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>U())},[s(l)==-1||s(n)[s(l)].ref_id==null&&s(n)[s(l)].confirmed_by==null?(f(),j(y,{key:0})):(f(),j(A,{key:1}))]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>se())},[p(le)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",disabled:s(l)==-1||s(n)[s(l)].confirmed_by,onClick:t[3]||(t[3]=a=>X())},[p(ne)],8,Ne),e("button",{type:"button",name:"button",class:"m-1 text-2xl relative",onClick:t[4]||(t[4]=a=>Q())},[p(re),e("div",Pe,[s(H)>0?(f(),v("div",Oe)):ve("",!0)])]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=a=>te())},[p(ue)])]),e("form",Ve,[e("div",ze,[Fe,he(e("input",{class:"",type:"text","onUpdate:modelValue":t[6]||(t[6]=a=>ge(c)?c.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[ye,s(c)]])]),e("div",je,[e("button",{class:"",type:"submit",name:"button",onClick:t[7]||(t[7]=be(a=>Y(),["prevent"]))},[p(ie,{class:"text-2xl"})])])]),e("div",He,[s(n).length==0?(f(),v("div",Ke," Maaf Tidak Ada Record ")):(f(),v("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:W},[e("table",We,[Ye,e("tbody",null,[(f(!0),v(we,null,ke(s(n),(a,E)=>{var N,P,O,V,z;return f(),v("tr",{key:E,onClick:Xe=>l.value=E,class:xe(s(l)==E?"active":"")},[e("td",Ue,i(a.id),1),e("td",null,i(a.input_at?s(D)(a.input_at).format("DD-MM-Y"):""),1),e("td",null,i((N=a.warehouse)==null?void 0:N.name),1),e("td",null,i(a.note),1),e("td",null,i(a.status),1),e("td",null,i(a.type),1),e("td",null,i((P=a.warehouse_source)==null?void 0:P.name),1),e("td",null,i((O=a.warehouse_target)==null?void 0:O.name),1),e("td",null,i(a.confirmed_at?s(D)(a.confirmed_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,i((V=a.confirmer)==null?void 0:V.username),1),e("td",null,i(s(D)(a.requested_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,i((z=a.requester)==null?void 0:z.username),1)],10,Je)}),128))])])],544))])]),p(ce,{type:"delete",show:s(h),data:s(B),fnClose:ae,fnConfirm:oe},null,8,["show","data"])])}}};export{it as default};
