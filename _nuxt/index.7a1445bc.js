import{_ as K}from"./Header.cca1e452.js";import{_ as Y}from"./Plus.0d48322c.js";import{_ as Z}from"./Edit.e31c6ac9.js";import{_ as G}from"./Delete.cb6947d2.js";import{_ as Q}from"./Search.0b0b0847.js";import{_ as W}from"./PopupMini.vue.5e65727f.js";import{h as X,k as ee,r as c,i as te,y as L,z as ae,c as h,b as p,a as e,m as D,v as oe,n,A as le,B as H,F as se,C as re,l as ne,q as m,s as $,x as A,o as b,D as de,t as _,E as ie}from"./entry.bd9ce3f6.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.8161b2e5.js";const ue={class:"w-full h-full flex flex-col"},ce={class:"w-full flex grow flex-col overflow-auto h-0"},_e={class:"w-full flex"},fe={class:"w-full flex p-1"},pe={class:"grow"},me=e("div",{class:"font-bold"}," Keyword ",-1),ve={class:"pl-1"},he=e("div",{class:"font-bold"}," Sort By ",-1),be=e("option",{value:"created_at"},"Created At",-1),ye=e("option",{value:"id"},"ID",-1),ge=e("option",{value:"name"},"Name",-1),ke=[be,ye,ge],we={class:"pl-1"},xe=e("div",{class:"font-bold"}," Sort Order ",-1),De=e("option",{value:"asc"},"Asc",-1),$e=e("option",{value:"desc"},"Desc",-1),Ae=[De,$e],Ce={class:"flex items-end pl-1"},Se={class:"w-full flex justify-center items-center grow h-0 p-1"},Te={key:0,class:""},Be={class:"tacky"},ze=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",{class:"sticky left-0 !z-[2]"},"ID"),e("th",null,"Name"),e("th",null,"Created At"),e("th",null,"Created By"),e("th",null,"Updated At"),e("th",null,"Updated By")])],-1),Me=["onClick"],Le={class:"sticky left-0 !z-[1] bold"},Pe={__name:"index",async setup(He){let y,C;const{$moment:S}=ie(),s={};s._TimeZoneOffset=new Date().getTimezoneOffset(),s.sort="created_at:desc";const w=X("token"),{data:r}=([y,C]=ee(async()=>ne(async()=>{m().loading_full=!0;const{data:a,error:t,status:u}=await $("/api/units",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:s,retry:0},"$4c8HO0Dn0y");return m().loading_full=!1,u.value==="error"?(A().trigger(t),[]):a.value.data},"$OvLIT5s7hk")),y=await y,C(),y),f=c(""),i=c({field:"created_at",by:"desc"}),d=c(-1),l=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),E=()=>{s.like="",f.value!=""&&(s.like=`id:%${f.value}%,name:%${f.value}%`),s.sort="",i.field&&(s.sort=i.value.field+":"+i.value.by)},g=c(null),T=async()=>{m().loading_full=!0,l.value.may_get_data=!1,s.page=l.value.page,s.page==1&&(r.value=[]),s.page>1&&(s.first_row=JSON.stringify(r.value[0]));const{data:a,error:t,status:u}=await $("/api/units",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:s,retry:0},"$Gq4gZ0gTJm");if(m().loading_full=!1,l.value.may_get_data=!0,u.value==="error"){A().trigger(t);return}l.value.page==1?(r.value=a.value.data,g.value&&(g.value.scrollTop=0)):l.value.page>1&&(r.value=[...r.value,...a.value.data]),a.value.data.length==0&&(l.value.is_last_record=!0)},I=async()=>{if(!l.value.may_get_data)return;let a=g.value;if(a.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=a.scrollLeft;return}l.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(l.value.page++,await T())},N=()=>{l.value.page=1,l.value.is_last_record=!1,E(),T()},B=te(),F=()=>{B.push({name:"data_satuan-form",query:{id:""}})},{display:z}=L();ae(L());const O=()=>{d.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):B.push({name:"data_satuan-form",query:{id:r.value[d.value].id}})},M=c({}),v=c(!1),R=async()=>{v.value&&(v.value=!1)},j=()=>{d.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(M.value={id:r.value[d.value].id,name:r.value[d.value].name},v.value=!0)},U=async()=>{m().loading_full=!0;const a=new FormData;a.append("id",r.value[d.value].id),a.append("_method","DELETE");const{data:t,error:u,status:x}=await $("/api/unit",{method:"post",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:a,retry:0},"$r0wxghz9ds");if(m().loading_full=!1,x.value==="error"){A().trigger(u);return}r.value.splice(d.value,1),v.value=!1};return(a,t)=>{const u=K,x=Y,V=Z,q=G,P=Q,J=W;return b(),h("div",ue,[p(u,{title:"List unit"}),e("div",ce,[e("div",_e,[e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[0]||(t[0]=o=>F())},[p(x)]),e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[1]||(t[1]=o=>O())},[p(V)]),e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[2]||(t[2]=o=>j())},[p(q)])]),e("div",fe,[e("div",pe,[me,D(e("input",{class:"w-full border-black border-solid border-2 p-1",type:"text","onUpdate:modelValue":t[3]||(t[3]=o=>le(f)?f.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[oe,n(f)]])]),e("div",ve,[he,D(e("select",{class:"w-full border-black border-solid border-2 p-1","onUpdate:modelValue":t[4]||(t[4]=o=>n(i).field=o)},ke,512),[[H,n(i).field]])]),e("div",we,[xe,D(e("select",{class:"w-full border-black border-solid border-2 p-1","onUpdate:modelValue":t[5]||(t[5]=o=>n(i).by=o)},Ae,512),[[H,n(i).by]])]),e("div",Ce,[e("button",{class:"w-full border-black border-solid border-2 p-1",type:"button",name:"button",onClick:t[6]||(t[6]=o=>N())},[p(P,{class:"text-2xl"})])])]),e("div",Se,[n(r).length==0?(b(),h("div",Te," Maaf Tidak Ada Record ")):(b(),h("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:g,onScroll:I},[e("table",Be,[ze,e("tbody",null,[(b(!0),h(se,null,re(n(r),(o,k)=>(b(),h("tr",{key:k,onClick:Ee=>d.value=k,class:de(n(d)==k?"active":"")},[e("td",null,_(k+1)+".",1),e("td",Le,_(o.id),1),e("td",null,_(o.name),1),e("td",null,_(n(S)(o.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,_(o.creator.username),1),e("td",null,_(n(S)(o.updated_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,_(o.updator.username),1)],10,Me))),128))])])],544))])]),p(J,{type:"delete",show:n(v),data:n(M),fnClose:R,fnConfirm:U},null,8,["show","data"])])}}};export{Pe as default};
