import{_ as B}from"./HeaderPopup.vue.fe14bc58.js";import E from"./Search.9b037104.js";import{g as R,r as f,f as V,k as g,J as q,o as m,c as v,a as e,b as D,m as I,A as N,l as n,v as M,C as j,F as z,D as O,E as U,t as _,G as J,p as K,e as Y,x as A,y as G}from"./entry.468c1924.js";import{u as P}from"./useUtils.f67a7b52.js";import{u as Z}from"./useMyFetch.5d39e20e.js";import{_ as Q}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.725e6b46.js";const r=c=>(K("data-v-d6afa38a"),c=c(),Y(),c),W={class:"box-fixed"},X={action:"#",class:"w-full flex p-1"},ee={class:"grow"},te=r(()=>e("div",{class:"font-bold"}," Keyword ",-1)),le={class:"pl-1"},se=r(()=>e("div",{class:"font-bold"}," Sort By ",-1)),ae=r(()=>e("option",{value:"created_at"},"Created At",-1)),oe=r(()=>e("option",{value:"email"},"Email",-1)),ne=r(()=>e("option",{value:"fullname"},"Fullname",-1)),re=[ae,oe,ne],ie={class:"pl-1"},ce=r(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),ue=r(()=>e("option",{value:"asc"},"Asc",-1)),de=r(()=>e("option",{value:"desc"},"Desc",-1)),fe=[ue,de],_e={class:"flex items-end pl-1"},pe={class:"w-full flex justify-center items-center grow h-0 p-1"},me={key:0,class:""},ve={class:"tacky"},he=r(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Email"),e("th",null,"Fullname"),e("th",null,"Role"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),ye=["onClick"],ge={class:"bold"},we={class:"flex",style:{"justify-content":"end",padding:"5px"}},ke={__name:"users",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1}},setup(c){const w=c,{$moment:b}=J(),{countClickListFn:F}=P(),T=R("token"),i=f([]),d=f(""),u=f({field:"created_at",by:"desc"}),h=f(-1),l=f({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),a={};a._TimeZoneOffset=new Date().getTimezoneOffset();const $=()=>{a.like="",d.value!=""&&(a.like=`email:%${d.value}%,fullname:%${d.value}%`),a.sort="",u.value.field&&(a.sort=u.value.field+":"+u.value.by)},y=f(null),S=async()=>{A().loading_full=!0,l.value.may_get_data=!1,a.page=l.value.page,a.page==1&&(i.value=[]),a.first_row&&delete a.first_row,a.page>1&&(a.first_row=JSON.stringify(i.value[0]));const{data:o,error:t,status:k}=await Z("/api/users",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:a,retry:0});if(A().loading_full=!1,l.value.may_get_data=!0,k.value==="error"){G().trigger(t);return}l.value.page==1?(i.value=o.value.data,y.value&&(y.value.scrollTop=0)):l.value.page>1&&(i.value=[...i.value,...o.value.data]),o.value.data.length==0&&(l.value.is_last_record=!0)},H=async()=>{if(!l.value.may_get_data)return;let o=y.value;if(o.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=o.scrollLeft;return}l.value.is_last_record||!(Math.round(o.scrollTop)+o.clientHeight>=o.scrollHeight-1)||(l.value.page++,await S())},x=()=>{l.value.page=1,l.value.is_last_record=!1,$(),S()},C=()=>{h.value>-1?w.fnSelect(i.value[h.value]):w.fnSelect({id:"",email:"",fullname:""})};return V(()=>w.show,(o,t)=>{o==!0&&x()},{immediate:!0}),(o,t)=>{const k=B,L=E;return g((m(),v("section",W,[e("div",null,[D(k,{title:"Search And Select Employees",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",X,[e("div",ee,[te,g(e("input",{class:"",type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>I(d)?d.value=s:null),name:"search",placeholder:"Keyword"},null,512),[[N,n(d)]])]),e("div",le,[se,g(e("select",{class:"","onUpdate:modelValue":t[1]||(t[1]=s=>n(u).field=s)},re,512),[[M,n(u).field]])]),e("div",ie,[ce,g(e("select",{class:"","onUpdate:modelValue":t[2]||(t[2]=s=>n(u).by=s)},fe,512),[[M,n(u).by]])]),e("div",_e,[e("button",{class:"",type:"submit",name:"button",onClick:t[3]||(t[3]=j(s=>x(),["prevent"]))},[D(L,{class:"text-2xl"})])])]),e("div",pe,[n(i).length==0?(m(),v("div",me," Maaf Tidak Ada Record ")):(m(),v("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:y,onScroll:H},[e("table",ve,[he,e("tbody",null,[(m(!0),v(z,null,O(n(i),(s,p)=>(m(),v("tr",{key:p,onClick:be=>n(F)(p,()=>{h.value=p},C),class:U(n(h)==p?"active":"")},[e("td",null,_(p+1)+".",1),e("td",ge,_(s.email),1),e("td",null,_(s.fullname),1),e("td",null,_(s.role),1),e("td",null,_(n(b)(s.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,_(n(b)(s.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,ye))),128))])])],544))]),e("div",we,[e("button",{onClick:t[4]||(t[4]=s=>C()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[q,c.show]])}}},Te=Q(ke,[["__scopeId","data-v-d6afa38a"]]);export{Te as default};
