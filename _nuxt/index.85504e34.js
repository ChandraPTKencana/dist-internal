import{_ as X}from"./Header.695f357d.js";import{_ as ee}from"./Plus.970982c5.js";import{_ as te}from"./Edit.a41df7c2.js";import{_ as oe}from"./Delete.537b7c45.js";import{_ as ae}from"./Search.face49e0.js";import{_ as se}from"./PopupMini.vue.b32b6872.js";import{_ as le}from"./PopupSingleImage.vue.69be47c7.js";import{q as ne,x as re,r as c,s as ue,E as H,F as ie,c as m,b as p,a as e,z as D,A as ce,B as s,G as de,H as I,N as _e,I as fe,J as pe,y as me,C as v,D as A,o as h,K as ve,t as u,O as he,L as ye}from"./entry.78b18dc9.js";import{u as ge}from"./useUtils.100f5b4a.js";import{u as $}from"./useMyFetch.7bf5776a.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.9a0b15d1.js";const we={class:"w-full h-full flex flex-col"},xe={class:"w-full flex grow flex-col overflow-auto h-0"},be={class:"w-full flex"},ke={action:"#",class:"w-full flex p-1"},Ce={class:"grow"},De=e("div",{class:"font-bold"}," Keyword ",-1),Ae={class:"pl-1"},$e=e("div",{class:"font-bold"}," Sort By ",-1),Be=e("option",{value:"created_at"},"Created At",-1),Se=e("option",{value:"name"},"Name",-1),Me=e("option",{value:"value"},"Value",-1),Ne=[Be,Se,Me],Te={class:"pl-1"},Le=e("div",{class:"font-bold"}," Sort Order ",-1),Ee=e("option",{value:"asc"},"Asc",-1),He=e("option",{value:"desc"},"Desc",-1),Ie=[Ee,He],Ve={class:"flex items-end pl-1"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},ze={key:0,class:""},Fe={class:"tacky"},Ue=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Photo"),e("th",null,"Name"),e("th",null,"Unit"),e("th",null,"Value"),e("th",null,"Note"),e("th",null,"Created At"),e("th",null,"Created By"),e("th",null,"Updated At"),e("th",null,"Updated By")])],-1),Pe=["onClick"],Re={class:"bold"},Oe={class:"p-0"},qe=["onClick"],Ke=["src"],nt={__name:"index",async setup(Je){let g,B;const{$moment:S}=ye(),{pointFormat:V}=ge(),l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="created_at:desc";const b=ne("token"),{data:r}=([g,B]=re(async()=>me(async()=>{v().loading_full=!0;const{data:a,error:o,status:f}=await $("/api/items",{method:"get",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},params:l,retry:0});return v().loading_full=!1,f.value==="error"?(A().trigger(o),[]):a.value.data},"$hEoAojBvbD")),g=await g,B(),g),d=c(""),_=c({field:"created_at",by:"desc"}),i=c(-1),n=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),j=()=>{l.like="",d.value!=""&&(l.like=`id:%${d.value}%,name:%${d.value}%,value:%${d.value}%`),l.sort="",_.value.field&&(l.sort=_.value.field+":"+_.value.by)},w=c(null),M=async()=>{v().loading_full=!0,n.value.may_get_data=!1,l.page=n.value.page,l.page==1&&(r.value=[]),l.first_row&&delete l.first_row,l.page>1&&(l.first_row=JSON.stringify(r.value[0]));const{data:a,error:o,status:f}=await $("/api/items",{method:"get",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},params:l,retry:0});if(v().loading_full=!1,n.value.may_get_data=!0,f.value==="error"){A().trigger(o);return}n.value.page==1?(r.value=a.value.data,w.value&&(w.value.scrollTop=0)):n.value.page>1&&(r.value=[...r.value,...a.value.data]),a.value.data.length==0&&(n.value.is_last_record=!0)},z=async()=>{if(!n.value.may_get_data)return;let a=w.value;if(a.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=a.scrollLeft;return}n.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(n.value.page++,await M())},F=()=>{n.value.page=1,n.value.is_last_record=!1,j(),M()},N=ue(),U=()=>{N.push({name:"data_item-form",query:{id:""}})},{display:T}=H();ie(H());const P=()=>{i.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):N.push({name:"data_item-form",query:{id:r.value[i.value].id}})},L=c({}),y=c(!1),R=async()=>{y.value&&(y.value=!1)},O=()=>{i.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(L.value={id:r.value[i.value].id},y.value=!0)},q=async()=>{v().loading_full=!0;const a=new FormData;a.append("id",r.value[i.value].id),a.append("_method","DELETE");const{data:o,error:f,status:C}=await $("/api/item",{method:"post",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},body:a,retry:0});if(v().loading_full=!1,C.value==="error"){A().trigger(f);return}r.value.splice(i.value,1),i.value=-1,y.value=!1},k=c(!1),E=c(""),K=a=>{k.value=!0,E.value=a};return(a,o)=>{const f=X,C=ee,J=te,Y=oe,G=ae,Z=se,Q=le;return h(),m("div",we,[p(f,{title:"List Item"}),e("div",xe,[e("div",be,[e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[0]||(o[0]=t=>U())},[p(C)]),e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[1]||(o[1]=t=>P())},[p(J)]),e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[2]||(o[2]=t=>O())},[p(Y)])]),e("form",ke,[e("div",Ce,[De,D(e("input",{class:"",type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>de(d)?d.value=t:null),name:"search",placeholder:"Keyword"},null,512),[[ce,s(d)]])]),e("div",Ae,[$e,D(e("select",{class:"","onUpdate:modelValue":o[4]||(o[4]=t=>s(_).field=t)},Ne,512),[[I,s(_).field]])]),e("div",Te,[Le,D(e("select",{class:"","onUpdate:modelValue":o[5]||(o[5]=t=>s(_).by=t)},Ie,512),[[I,s(_).by]])]),e("div",Ve,[e("button",{class:"",type:"submit",name:"button",onClick:o[6]||(o[6]=_e(t=>F(),["prevent"]))},[p(G,{class:"text-2xl"})])])]),e("div",je,[s(r).length==0?(h(),m("div",ze," Maaf Tidak Ada Record ")):(h(),m("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:w,onScroll:z},[e("table",Fe,[Ue,e("tbody",null,[(h(!0),m(fe,null,pe(s(r),(t,x)=>(h(),m("tr",{key:x,onClick:W=>i.value=x,class:ve(s(i)==x?"active":"")},[e("td",null,u(x+1)+".",1),e("td",Re,u(t.id),1),e("td",Oe,[t.photo?(h(),m("div",{key:0,class:"absolute w-full h-full flex items-center justify-center cursor-pointer",onClick:W=>K(t.photo)},[e("img",{src:t.photo||"/stok/user-default.png",alt:"",class:"max-w-full max-h-full"},null,8,Ke)],8,qe)):he("",!0)]),e("td",null,u(t.name),1),e("td",null,u(t.unit.name),1),e("td",null,u(s(V)(t.value)),1),e("td",null,u(t.note),1),e("td",null,u(s(S)(t.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(t.creator.username),1),e("td",null,u(s(S)(t.updated_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(t.updator.username),1)],10,Pe))),128))])])],544))])]),p(Z,{type:"delete",show:s(y),data:s(L),fnClose:R,fnConfirm:q},null,8,["show","data"]),p(Q,{show:s(k),photo:s(E),fnClose:()=>{k.value=!1}},null,8,["show","photo","fnClose"])])}}};export{nt as default};
