import{_ as R}from"./HeaderCustom.vue.2274acf9.js";import{_ as T}from"./InputPointFormat.vue.52a40116.js";import{_ as V}from"./Search.cd740c5d.js";import{_ as K}from"./Delete.797ef27c.js";import{_ as O}from"./HeaderPopup.vue.2983f6f3.js";import{q as L,r as y,g as E,z as S,M as P,o as g,c as $,a as e,b,G as J,A as H,B as t,H as B,N as z,I as F,J as Q,K as Y,t as d,L as G,p as Z,e as W,C,D as j,n as X,u as ee,s as te,v as se,x as oe,y as le}from"./entry.a58c45cf.js";import{u as ae}from"./useUtils.100f5b4a.js";import{u as q}from"./useMyFetch.bcdb1556.js";import{_ as ne}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.bc001055.js";const v=h=>(Z("data-v-94d8cd3c"),h=h(),W(),h),ie={class:"box-fixed"},re={action:"#",class:"w-full flex p-1"},ce={class:"grow"},ue=v(()=>e("div",{class:"font-bold"}," Keyword ",-1)),de={class:"pl-1"},_e=v(()=>e("div",{class:"font-bold"}," Sort By ",-1)),fe=v(()=>e("option",{value:"created_at"},"Created At",-1)),pe=v(()=>e("option",{value:"id"},"ID",-1)),me=v(()=>e("option",{value:"name"},"Nama",-1)),ve=[fe,pe,me],he={class:"pl-1"},xe=v(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),we=v(()=>e("option",{value:"asc"},"Asc",-1)),ye=v(()=>e("option",{value:"desc"},"Desc",-1)),ge=[we,ye],$e={class:"flex items-end pl-1"},be={class:"w-full flex justify-center items-center grow h-0 p-1"},ke={key:0,class:""},Se={class:"tacky"},Ce=v(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1)),Ae=["onClick"],De={class:"bold"},Ue={class:"flex",style:{"justify-content":"end",padding:"5px"}},Ie={__name:"units",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1}},setup(h){const x=h,{$moment:A}=G(),{countClickListFn:U}=ae(),p=L("token"),_=y([]),m=y(""),f=y({field:"created_at",by:"desc"}),o=y(-1),n=y({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),r={};r._TimeZoneOffset=new Date().getTimezoneOffset();const M=()=>{r.like="",m.value!=""&&(r.like=`id:%${m.value}%,name:%${m.value}%`),r.sort="",f.value.field&&(r.sort=f.value.field+":"+f.value.by)},k=y(null),I=async()=>{C().loading_full=!0,n.value.may_get_data=!1,r.page=n.value.page,r.page==1&&(_.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(_.value[0]));const{data:l,error:a,status:w}=await q("/api/units",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:r,retry:0});if(C().loading_full=!1,n.value.may_get_data=!0,w.value==="error"){j().trigger(a);return}n.value.page==1?(_.value=l.value.data,k.value&&(k.value.scrollTop=0)):n.value.page>1&&(_.value=[..._.value,...l.value.data]),l.value.data.length==0&&(n.value.is_last_record=!0)},N=async()=>{if(!n.value.may_get_data)return;let l=k.value;if(l.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=l.scrollLeft;return}n.value.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1)||(n.value.page++,await I())},u=()=>{n.value.page=1,n.value.is_last_record=!1,M(),I()},s=()=>{o.value>-1?x.fnSelect(_.value[o.value]):x.fnSelect({id:"",name:""})};return E(()=>x.show,(l,a)=>{l==!0&&u()},{immediate:!0}),(l,a)=>{const w=O,D=V;return S((g(),$("section",ie,[e("div",null,[b(w,{title:"Search And Select Unit",fn:h.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",re,[e("div",ce,[ue,S(e("input",{class:"",type:"text","onUpdate:modelValue":a[0]||(a[0]=c=>J(m)?m.value=c:null),name:"search",placeholder:"Keyword"},null,512),[[H,t(m)]])]),e("div",de,[_e,S(e("select",{class:"","onUpdate:modelValue":a[1]||(a[1]=c=>t(f).field=c)},ve,512),[[B,t(f).field]])]),e("div",he,[xe,S(e("select",{class:"","onUpdate:modelValue":a[2]||(a[2]=c=>t(f).by=c)},ge,512),[[B,t(f).by]])]),e("div",$e,[e("button",{class:"",type:"submit",name:"button",onClick:a[3]||(a[3]=z(c=>u(),["prevent"]))},[b(D,{class:"text-2xl"})])])]),e("div",be,[t(_).length==0?(g(),$("div",ke," Maaf Tidak Ada Record ")):(g(),$("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:N},[e("table",Se,[Ce,e("tbody",null,[(g(!0),$(F,null,Q(t(_),(c,i)=>(g(),$("tr",{key:i,onClick:at=>t(U)(i,()=>{o.value=i},s),class:Y(t(o)==i?"active":"")},[e("td",null,d(i+1)+".",1),e("td",De,d(c.id),1),e("td",null,d(c.name),1),e("td",null,d(t(A)(c.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,d(t(A)(c.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ae))),128))])])],544))]),e("div",Ue,[e("button",{onClick:a[4]||(a[4]=c=>s()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[P,h.show]])}}},Me=ne(Ie,[["__scopeId","data-v-94d8cd3c"]]),Ne={class:"w-full h-full flex flex-col"},He={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},je={class:"w-full align-items-center justify-content-center grow overflow-auto"},qe={class:"w-full flex flex-col flex-wrap p-1"},Be=e("label",{for:""},"Name",-1),Ve={class:"text-red-500"},Le={class:"w-full flex flex-col flex-wrap p-1"},ze=e("label",{for:""},"Value",-1),Fe={class:"text-red-500"},Re={class:"w-full flex flex-col flex-wrap p-1"},Te=e("label",{for:""},"Note",-1),Ke={class:"text-red-500"},Oe={class:"w-full flex flex-col flex-wrap p-1"},Ee=e("label",{for:""},"Unit",-1),Pe={class:"card-border flex flex-row flex-wrap"},Je={key:0,class:"w-full flex"},Qe=e("div",{class:"flex items-center grow p-1"}," Pilih Unit ",-1),Ye={key:1,class:"w-full flex",style:{}},Ge={class:"flex flex-row flex-wrap grow"},Ze={class:"p-1"},We=e("div",{class:"text-sm text-gray-600"},"ID",-1),Xe={class:"bold"},et={class:"p-1"},tt=e("div",{class:"text-sm text-gray-600"},"Email",-1),st={class:"bold"},ot={class:"text-red-500"},lt={class:"w-full flex items-center justify-end"},vt=X({__name:"form",async setup(h){let x,A;ee();const U=L("token"),p=y({}),_=te(),m=se();let f={id:"",name:""};const{data:o}=([x,A]=oe(async()=>le(async()=>{const u=m.query.id;if(u!==void 0&&u!==""){C().loading_full=!0;const{data:s,error:l,status:a}=await q("/api/item",{method:"get",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},params:{id:u},retry:0});if(C().loading_full=!1,a.value==="error")j().trigger(l,p);else return s.value.data}return{id:-1,name:"",value:0,note:"",unit:{...f}}},"$eQTKQHw4Kq")),x=await x,A(),x);let n=y(!1);const r=()=>{o.value.unit={...f}},M=()=>{n.value=!0},k=()=>{n.value=!1},I=u=>{o.value.unit=u,n.value=!1},N=async()=>{C().loading_full=!0,p.value={};let u={name:o.value.name,value:o.value.value,note:o.value.note,unit_id:o.value.unit.id},s="post",l=m.query.id;l===""||(s="put",u.id=l);const{data:a,error:w,status:D}=await q("/api/item",{method:s,headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},body:u,retry:0});if(C().loading_full=!1,D.value==="error"){j().trigger(w,p);return}_.go(-1)};return(u,s)=>{const l=R,a=T,w=V,D=K,c=Me;return g(),$(F,null,[e("div",Ne,[b(l,{title:"Form Item",back:!0}),e("form",He,[e("div",je,[e("div",qe,[Be,S(e("input",{class:"",type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>t(o).name=i)},null,512),[[H,t(o).name]]),e("p",Ve,d(t(p).name),1)]),e("div",Le,[ze,b(a,{class:"",type:"text",value:t(o).value,onInput:s[1]||(s[1]=i=>t(o).value=i)},null,8,["value"]),e("p",Fe,d(t(p).value),1)]),e("div",Re,[Te,S(e("textarea",{class:"","onUpdate:modelValue":s[2]||(s[2]=i=>t(o).note=i)},null,512),[[H,t(o).note]]),e("p",Ke,d(t(p).note),1)]),e("div",Oe,[Ee,e("div",Pe,[!t(o).unit||!t(o).unit.id?(g(),$("div",Je,[e("button",{type:"button",onClick:s[3]||(s[3]=i=>M()),class:"flex items-center grow"},[b(w,{class:"text-2xl text-black"}),Qe])])):(g(),$("div",Ye,[e("div",Ge,[e("div",Ze,[We,e("div",Xe,d(t(o).unit.id),1)]),e("div",et,[tt,e("div",st,d(t(o).unit.name),1)])]),e("button",{type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:s[4]||(s[4]=i=>r())},[b(D,{class:"text-2xl text-white"})])]))]),e("p",ot,d(t(p).unit_id),1)])]),e("div",lt,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[5]||(s[5]=i=>u.$router.go(-1))}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[6]||(s[6]=z(i=>N(),["prevent"]))}," Save ")])])]),b(c,{show:t(n),fnClose:k,fnSelect:I,excludes:"item_had_which_item_id"},null,8,["show"])],64)}}});export{vt as default};
