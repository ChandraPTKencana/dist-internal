import{_ as Oe}from"./HeaderCustom.vue.88a61c86.js";import{_ as pe}from"./Search.9ec806b4.js";import{_ as Re}from"./Delete.5b82ae06.js";import{_ as de}from"./_plugin-vue_export-helper.c27b6911.js";import{o,c as a,a as e,n as me,r as _,g as le,Q as Fe,b as S,I as J,J as oe,t as f,B as t,K as E,P as $,q as ve,z as O,M as he,G as $e,A as re,H as ae,N as we,d as Be,L as Se,p as Ce,e as Ie,C as Y,D as ue,u as Ve,s as He,v as Ue,x as ze,y as Pe,R as ge,S as ke}from"./entry.77eabeba.js";import{_ as Me}from"./Times.44e3952a.js";import{_ as Ke}from"./InputPointFormat.vue.19b6a870.js";import{_ as We}from"./Plus.2432cc16.js";import{_ as Ae}from"./HeaderPopup.vue.3d1b520d.js";import{u as Te}from"./useUtils.100f5b4a.js";import{u as ce}from"./useMyFetch.c95bfc0b.js";const Ee={name:"TablerTools"},Ye={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Je=e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M3 21h4L20 8a1.5 1.5 0 0 0-4-4L3 17zM14.5 5.5l4 4"}),e("path",{d:"M12 8L7 3L3 7l5 5M7 8L5.5 9.5M16 12l5 5l-4 4l-5-5m4 1l-1.5 1.5"})],-1),Qe=[Je];function Ze(n,c,w,M,v,u){return o(),a("svg",Ye,Qe)}const Ge=de(Ee,[["render",Ze]]),Xe={key:0,class:"flex items-center justify-center fixed top-0 left-0 z-10 p-3 w-full h-full bg-black bg-opacity-80"},et={class:"flex items-center max-w-xs w-full h-5/6 relative bg-white border-solid border-gray-600 border-2 p-3 flex-col"},tt={class:"absolute -top-7 right-0 py-1 px-2 bg-white border-solid border-2 border-gray-600 border-b-0 rounded-tl-md"},st={class:"w-full grow text-left mt-3 flex-col overflow-hidden"},lt=e("b",{class:"text-gray-600"},"Selected List:",-1),ot={class:"w-full h-full grow overflow-auto p-2"},at={class:"w-full flex flex-row flex-wrap items-center bg-blue-500 my-1 text-white rounded justify-between"},nt={class:"flex flex-row flex-wrap items-center"},it={class:"p-1"},rt={class:"flex w-full justify-between mt-5"},ut=["disabled"],ct=me({__name:"PopupMiniMulti",props:{show:{type:Boolean,required:!0},data:{type:Object,required:!1,default:""},fnClose:{type:Function,required:!0},fnConfirm:{type:Function,required:!0},fnRemoveFromList:{type:Function,required:!0},enabledOk:{type:Boolean,required:!1,default:!0},multi_key:{type:Array,required:!0}},setup(n){const c=n;let w=null;const M=_(0),v=()=>{w==null&&(M.value=1,w=setInterval(()=>{M.value--,M.value<=0&&(clearInterval(w),w=null)},1e3))};return le(()=>c.show,(u,d)=>{u?v():(clearInterval(w),w=null)},{immediate:!0,deep:!0}),le(()=>c.enabledOk,(u,d)=>{u&&c.show&&v()},{immediate:!0,deep:!0}),Fe(()=>{clearInterval(w),w=null}),(u,d)=>{const y=Me;return n.show?(o(),a("div",Xe,[e("div",et,[e("div",tt,[S(y,{class:"text-2xl text-black cursor-pointer",onClick:d[0]||(d[0]=C=>n.fnClose())})]),e("div",st,[lt,e("div",ot,[(o(!0),a(J,null,oe(n.data,(C,s)=>(o(),a("div",at,[e("div",nt,[(o(!0),a(J,null,oe(n.multi_key,i=>(o(),a("div",it,f(C[i]),1))),256))]),S(y,{class:"text-2xl cursor-pointer",onClick:i=>n.fnRemoveFromList(s)},null,8,["onClick"])]))),256))])]),e("div",rt,[e("button",{onClick:d[1]||(d[1]=C=>n.fnClose()),class:"w-full bg-blue-500 border-blue-500 border-solid border-2 p-1 text-white mr-2"}," Tutup "),e("button",{onClick:d[2]||(d[2]=C=>n.fnConfirm()),disabled:!c.enabledOk||t(M)>0,class:E(["w-full border-solid border-2 p-1 text-white",c.enabledOk&&t(M)<=0?"bg-red-600 border-red-600":"bg-slate-600 border-slate-600"])}," Lanjutkan "+f(t(M)>0?t(M):""),11,ut)])])])):$("",!0)}}});const D=n=>(Ce("data-v-d0674591"),n=n(),Ie(),n),dt={class:"box-fixed"},_t={action:"#",class:"w-full flex p-1"},ft={class:"grow"},pt=D(()=>e("div",{class:"font-bold"}," Keyword ",-1)),mt={class:"pl-1"},vt=D(()=>e("div",{class:"font-bold"}," Sort By ",-1)),ht=D(()=>e("option",{value:"created_at"},"Created At",-1)),wt=D(()=>e("option",{value:"id"},"ID",-1)),yt=D(()=>e("option",{value:"name"},"Nama",-1)),xt=[ht,wt,yt],bt={class:"pl-1"},gt=D(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),kt=D(()=>e("option",{value:"asc"},"Asc",-1)),$t=D(()=>e("option",{value:"desc"},"Desc",-1)),St=[kt,$t],Ct={class:"flex items-end pl-1"},It={class:"w-full flex justify-center items-center grow h-0 p-1"},Mt={key:0,class:""},At={class:"tacky w-full"},Tt={class:"sticky top-0 !z-[2]"},qt={key:0,class:"min-w-[28px] !w-[28px] max-w-[28px]"},jt=D(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No.",-1)),Dt=D(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID",-1)),Lt=D(()=>e("th",null,"Name",-1)),Nt=D(()=>e("th",null,"Unit",-1)),Ot=D(()=>e("th",{class:"min-w-[170px] !w-[170px] max-w-[170px]"},"Created At",-1)),Rt=D(()=>e("th",{class:"min-w-[170px] !w-[170px] max-w-[170px]"},"Updated At",-1)),Ft=["onClick"],Bt={key:0},Vt=["checked","onClick"],Ht={class:"bold"},Ut={class:"whitespace-normal break-words"},zt={class:"flex",style:{"justify-content":"end",padding:"5px"}},Pt={key:0,class:"grow flex items-center"},Kt={__name:"items",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},fnSelectMulti:{type:Function,required:!1},enableMultiSelect:{type:Boolean,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},multi_key:{type:Array,required:!1}},setup(n){const c=n,{$moment:w}=Se(),{countClickListFn:M}=Te(),v=ve("token"),u=_([]),d=_(""),y=_({field:"created_at",by:"desc"}),C=_(-1),s=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),i={};i._TimeZoneOffset=new Date().getTimezoneOffset();const I=()=>{i.like="",d.value!=""&&(i.like=`id:%${d.value}%,name:%${d.value}%`),i.sort="",y.value.field&&(i.sort=y.value.field+":"+y.value.by)},L=_(null),N=async()=>{Y().loading_full=!0,s.value.may_get_data=!1,i.page=s.value.page,i.page==1&&(u.value=[]),c.exclude_lists&&(i.exclude_lists=JSON.stringify(c.exclude_lists)),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(u.value[0]));const{data:m,error:h,status:T}=await ce("/api/items",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:i,retry:0});if(Y().loading_full=!1,s.value.may_get_data=!0,T.value==="error"){ue().trigger(h);return}s.value.page==1?(u.value=m.value.data,L.value&&(L.value.scrollTop=0)):s.value.page>1&&(u.value=[...u.value,...m.value.data]),m.value.data.length==0&&(s.value.is_last_record=!0)},ee=async()=>{if(!s.value.may_get_data)return;let m=L.value;if(m.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=m.scrollLeft;return}s.value.is_last_record||!(Math.round(m.scrollTop)+m.clientHeight>=m.scrollHeight-1)||(s.value.page++,await N())},H=()=>{s.value.page=1,s.value.is_last_record=!1,I(),N()},B=_(!1),q=_([]),U=()=>{c.enableMultiSelect?(c.fnSelectMulti(q.value),B.value=!1):C.value>-1?c.fnSelect(u.value[C.value]):c.fnSelect({id:"",name:""})},te=m=>{c.enableMultiSelect||M(m,()=>{C.value=m},U)},A=m=>{q.value.splice(m,1)},x=async()=>{B.value&&(B.value=!1)},V=m=>{const h=q.value.map(T=>T.id).indexOf(m.id);h===-1?q.value.push(m):q.value.splice(h,1)},Q=m=>q.value.map(T=>T.id).indexOf(m.id)!==-1,b=_(null);let R=null;const ne=m=>{R&&clearTimeout(R),R=setTimeout(()=>{H()},500)};return le(()=>c.show,(m,h)=>{m==!0&&(q.value=[],H(),setTimeout(()=>{b.value.focus()},100))},{immediate:!0}),(m,h)=>{const T=Ae,G=pe,ie=ct;return o(),a(J,null,[O(e("section",dt,[e("div",null,[S(T,{title:"Search And Select Item",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",_t,[e("div",ft,[pt,O(e("input",{ref_key:"ref_keyword",ref:b,class:"",type:"text","onUpdate:modelValue":h[0]||(h[0]=g=>$e(d)?d.value=g:null),name:"search",placeholder:"Keyword",onKeyup:h[1]||(h[1]=g=>ne())},null,544),[[re,t(d)]])]),e("div",mt,[vt,O(e("select",{class:"","onUpdate:modelValue":h[2]||(h[2]=g=>t(y).field=g)},xt,512),[[ae,t(y).field]])]),e("div",bt,[gt,O(e("select",{class:"","onUpdate:modelValue":h[3]||(h[3]=g=>t(y).by=g)},St,512),[[ae,t(y).by]])]),e("div",Ct,[e("button",{class:"",type:"submit",name:"button",onClick:h[4]||(h[4]=we(g=>H(),["prevent"]))},[S(G,{class:"text-2xl"})])])]),e("div",It,[t(u).length==0?(o(),a("div",Mt," Maaf Tidak Ada Record ")):(o(),a("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:L,onScroll:ee},[e("table",At,[e("thead",null,[e("tr",Tt,[n.enableMultiSelect?(o(),a("th",qt)):$("",!0),jt,Dt,Lt,Nt,Ot,Rt])]),e("tbody",null,[(o(!0),a(J,null,oe(t(u),(g,X)=>(o(),a("tr",{key:X,onClick:_e=>te(X),class:E(t(C)==X?"active":"")},[n.enableMultiSelect?(o(),a("td",Bt,[e("input",{type:"checkbox",checked:Q(g),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",onClick:_e=>V(g)},null,8,Vt)])):$("",!0),e("td",null,f(X+1)+".",1),e("td",Ht,f(g.id),1),e("td",Ut,f(g.name),1),e("td",null,f(g.unit.name),1),e("td",null,f(t(w)(g.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,f(t(w)(g.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ft))),128))])])],544))]),e("div",zt,[n.enableMultiSelect?(o(),a("div",Pt,[Be(" Selected Items: "+f(t(q).length)+" ",1),e("button",{type:"button",class:"ml-3",onClick:h[5]||(h[5]=g=>B.value=!0)}," View all Items ")])):$("",!0),e("button",{onClick:h[6]||(h[6]=g=>U()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512),[[he,n.show]]),S(ie,{show:t(B),data:t(q),fnClose:x,fnConfirm:U,multi_key:n.multi_key,fnRemoveFromList:A},null,8,["show","data","multi_key"])],64)}}},Wt=de(Kt,[["__scopeId","data-v-d0674591"]]);const W=n=>(Ce("data-v-6030903a"),n=n(),Ie(),n),Et={class:"box-fixed"},Yt={action:"#",class:"w-full flex p-1"},Jt={class:"grow"},Qt=W(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Zt={class:"pl-1"},Gt=W(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Xt=W(()=>e("option",{value:"created_at"},"Created At",-1)),es=W(()=>e("option",{value:"id"},"ID",-1)),ts=W(()=>e("option",{value:"name"},"Nama",-1)),ss=[Xt,es,ts],ls={class:"pl-1"},os=W(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),as=W(()=>e("option",{value:"asc"},"Asc",-1)),ns=W(()=>e("option",{value:"desc"},"Desc",-1)),is=[as,ns],rs={class:"flex items-end pl-1"},us={class:"w-full flex justify-center items-center grow h-0 p-1"},cs={key:0,class:""},ds={class:"tacky"},_s=W(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1)),fs=["onClick"],ps={class:"bold"},ms={class:"flex",style:{"justify-content":"end",padding:"5px"}},vs={__name:"hrm_revisi_lokasis",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},opt:{type:String,required:!1},exclude:{type:Number,required:!1},exclude_lists:{type:Array,required:!1}},setup(n){const c=n,{$moment:w}=Se(),{countClickListFn:M}=Te(),v=ve("token"),u=_([]),d=_(""),y=_({field:"created_at",by:"desc"}),C=_(-1),s=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),i={};i._TimeZoneOffset=new Date().getTimezoneOffset();const I=()=>{i.like="",d.value!=""&&(i.like=`id:%${d.value}%,name:%${d.value}%`),i.sort="",y.value.field&&(i.sort=y.value.field+":"+y.value.by)},L=_(null),N=async()=>{Y().loading_full=!0,s.value.may_get_data=!1,i.opt=c.opt,i.exclude=c.exclude,i.page=s.value.page,i.page==1&&(u.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(u.value[0]));const{data:A,error:x,status:V}=await ce("/api/hrm_revisi_lokasis",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:i,retry:0});if(Y().loading_full=!1,s.value.may_get_data=!0,V.value==="error"){ue().trigger(x);return}s.value.page==1?(u.value=A.value.data,L.value&&(L.value.scrollTop=0)):s.value.page>1&&(u.value=[...u.value,...A.value.data]),A.value.data.length==0&&(s.value.is_last_record=!0)},ee=async()=>{if(!s.value.may_get_data)return;let A=L.value;if(A.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=A.scrollLeft;return}s.value.is_last_record||!(Math.round(A.scrollTop)+A.clientHeight>=A.scrollHeight-1)||(s.value.page++,await N())},H=()=>{s.value.page=1,s.value.is_last_record=!1,I(),N()},B=()=>{C.value>-1?c.fnSelect(u.value[C.value]):c.fnSelect({id:"",name:""})},q=_(null);let U=null;const te=A=>{U&&clearTimeout(U),U=setTimeout(()=>{H()},500)};return le(()=>c.show,(A,x)=>{A==!0&&H(),setTimeout(()=>{q.value.focus()},100)},{immediate:!0}),(A,x)=>{const V=Ae,Q=pe;return O((o(),a("section",Et,[e("div",null,[S(V,{title:"Search And Select Warehouse",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Yt,[e("div",Jt,[Qt,O(e("input",{ref_key:"ref_keyword",ref:q,class:"",type:"text","onUpdate:modelValue":x[0]||(x[0]=b=>$e(d)?d.value=b:null),name:"search",placeholder:"Keyword",onKeyup:x[1]||(x[1]=b=>te())},null,544),[[re,t(d)]])]),e("div",Zt,[Gt,O(e("select",{class:"","onUpdate:modelValue":x[2]||(x[2]=b=>t(y).field=b)},ss,512),[[ae,t(y).field]])]),e("div",ls,[os,O(e("select",{class:"","onUpdate:modelValue":x[3]||(x[3]=b=>t(y).by=b)},is,512),[[ae,t(y).by]])]),e("div",rs,[e("button",{class:"",type:"submit",name:"button",onClick:x[4]||(x[4]=we(b=>H(),["prevent"]))},[S(Q,{class:"text-2xl"})])])]),e("div",us,[t(u).length==0?(o(),a("div",cs," Maaf Tidak Ada Record ")):(o(),a("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:L,onScroll:ee},[e("table",ds,[_s,e("tbody",null,[(o(!0),a(J,null,oe(t(u),(b,R)=>(o(),a("tr",{key:R,onClick:ne=>t(M)(R,()=>{C.value=R},B),class:E(t(C)==R?"active":"")},[e("td",null,f(R+1)+".",1),e("td",ps,f(b.id),1),e("td",null,f(b.name),1),e("td",null,f(t(w)(b.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,f(t(w)(b.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,fs))),128))])])],544))]),e("div",ms,[e("button",{onClick:x[5]||(x[5]=b=>B()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[he,n.show]])}}},hs=de(vs,[["__scopeId","data-v-6030903a"]]),ws=me({__name:"ToolsPopup",props:{show:{type:Boolean,required:!0},coor:{type:Object,required:!1},fn:{type:Function,required:!0},only:{type:Object}},setup(n){const c=n,w=_(null),M=v=>{v.target.classList.contains("box")&&c.fn()};return le(()=>c.coor,(v,u)=>{v&&w.value&&(w.value.style.left=v.left+"px",w.value.style.top=v.top+"px")},{immediate:!0,deep:!0}),(v,u)=>O((o(),a("div",{class:"box",onClick:u[2]||(u[2]=d=>M(d))},[e("div",{ref_key:"popup",ref:w},[e("ul",null,[!n.only||n.only.length==0||n.only.indexOf("insert")>-1?(o(),a("li",{key:0,onClick:u[0]||(u[0]=d=>v.$emit("replyAct","insert"))},"Insert")):$("",!0),!n.only||n.only.length==0||n.only.indexOf("delete")>-1?(o(),a("li",{key:1,onClick:u[1]||(u[1]=d=>v.$emit("replyAct","delete"))},"Delete")):$("",!0)])],512)],512)),[[he,n.show]])}});const ys=de(ws,[["__scopeId","data-v-cde7f964"]]),xs={class:"w-full h-full flex flex-col"},bs={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},gs={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},ks={class:"w-full flex flex-row flex-wrap"},$s={key:0,class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},Ss=e("label",{for:""},"Input At",-1),Cs={class:"card-border"},Is={class:"w-full flex flex-col flex-wrap p-1 sm:w-4/12 md:w-3/12 lg:w-2/12"},Ms=e("label",{for:""},"Type",-1),As=["disabled"],Ts=e("option",{value:"used"},"Used",-1),qs=e("option",{value:"in"},"In",-1),js=e("option",{value:"transfer"},"Transfer",-1),Ds=[Ts,qs,js],Ls={class:"text-red-500"},Ns={class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},Os=e("label",{for:""},"From Warehouse",-1),Rs={class:"card-border flex flex-row flex-wrap"},Fs={key:0,class:"w-full flex"},Bs=e("div",{class:"flex items-center grow p-1"}," Pilih Warehouse yang dikelola ",-1),Vs={class:"flex flex-row flex-wrap grow"},Hs={class:"p-1"},Us=e("div",{class:"text-sm text-gray-600"},"ID",-1),zs={class:"bold"},Ps={class:"p-1"},Ks=e("div",{class:"text-sm text-gray-600"},"Name",-1),Ws={class:"bold"},Es={class:"flex flex-row flex-wrap grow"},Ys={class:"p-1"},Js=e("div",{class:"text-sm text-gray-600"},"ID",-1),Qs={class:"bold"},Zs={class:"p-1"},Gs=e("div",{class:"text-sm text-gray-600"},"Name",-1),Xs={class:"bold"},el={class:"text-red-500"},tl={key:1,class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},sl=e("label",{for:""},"To Warehouse",-1),ll={class:"card-border flex flex-row flex-wrap"},ol={key:0,class:"w-full flex"},al=e("div",{class:"flex items-center grow p-1"}," Pilih Warehouse Target ",-1),nl={class:"flex flex-row flex-wrap grow"},il={class:"p-1"},rl=e("div",{class:"text-sm text-gray-600"},"ID",-1),ul={class:"bold"},cl={class:"p-1"},dl=e("div",{class:"text-sm text-gray-600"},"Name",-1),_l={class:"bold"},fl={class:"text-red-500"},pl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ml=e("label",{for:""},"Note",-1),vl=["disabled"],hl={class:"text-red-500"},wl={class:"w-full flex grow p-1 overflow-auto"},yl={role:"sticky",ref:"loadRef"},xl={class:"tacky w-full",style:{"white-space":"normal"}},bl={class:"sticky top-0 !z-[2]"},gl={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},kl=e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1),$l={key:1,class:"min-w-[50px] !w-[50px] max-w-[50px]"},Sl=e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID Item",-1),Cl=e("th",null,"Nama Item",-1),Il=e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"Qty In",-1),Ml=e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"Qty Out",-1),Al=e("th",null,"Keterangan",-1),Tl={key:0},ql={key:0,class:"tools cell"},jl={class:"w-full h-full flex items-center justify-center"},Dl=["onClick"],Ll={key:1,class:"cell"},Nl={class:"w-full h-full flex items-center justify-center"},Ol=["onClick"],Rl=["onClick","disabled"],Fl={class:"w-full h-full flex items-center justify-center"},Bl={class:"w-full h-full flex items-center justify-center"},Vl={class:"cell"},Hl={class:"w-full h-full flex items-center justify-center"},Ul={class:"cell"},zl={class:"w-full h-full flex items-center justify-center"},Pl={class:"cell"},Kl={class:"w-full h-full flex items-center justify-center"},Wl=["disabled","onUpdate:modelValue"],El={key:0},Yl={class:"tools cell"},Jl={class:"w-full flex items-center justify-end"},io=me({__name:"form",async setup(n){var ye,xe,be;let c,w;Ve();const M=ve("token"),v=_({}),u=He(),d=Ue();let y={id:"",name:""};const{data:C}=([c,w]=ze(async()=>Pe(async()=>{const r=d.query.id;let l=null,j=null,z=null;if(r!==void 0&&r!==""){Y().loading_full=!0;const{data:P,error:se,status:fe}=await ce("/api/transaction",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{id:r},retry:0});Y().loading_full=!1,fe.value==="error"?ue().trigger(se,v):(l=P.value.data,z=P.value.data.details.map(K=>(K.status="Edit",K.key=K.ordinal,K)),j=P.value.data.details.map(K=>K.item.id))}return{transaction:l,exclude_lists:j,details:z}},"$RAej7t9zIe")),c=await c,w(),c),s=_(((ye=C.value)==null?void 0:ye.transaction)||{id:-1,type:"used",note:"",warehouse:{...y},warehouse_target:{...y},details:[]}),i=_(((xe=C.value)==null?void 0:xe.exclude_lists)||[]),I=_(((be=C.value)==null?void 0:be.details)||[]),L=_({ordinal:0,item:{id:"",name:"",unit:{id:"",name:""}},item_id:"",qty_in:0,qty_out:0,note:"",status:""}),N=_(!1),ee=()=>{N.value=!1},H=r=>{I.value[T.value].item=r,I.value[T.value].item_id=r.id,i.value.push(r.id),N.value=!1},B=r=>{r.forEach(l=>{let j={...L.value,status:"Add"};j.item=l,j.item_id=l.id,i.value.push(l.id),I.value.push(j)}),N.value=!1},q=_(!1),U=(r,l)=>{T.value=l,q.value=!1,N.value=!0},te=(r,l)=>{q.value=!0,N.value=!0},A=(r,l)=>{let j=I.value[l].item.id,z=i.value.indexOf(j);z>-1&&i.value.splice(z,1),I.value[l].item_id="",I.value[l].item={id:"",name:"",unit:{id:"",name:""}}};let x=_(!1),V="";const Q=r=>{r=="from"?s.value.warehouse={...y}:r=="to"&&(s.value.warehouse_target={...y})},b=r=>{V=r,x.value=!0},R=()=>{x.value=!1},ne=r=>{V=="from"?s.value.warehouse={...r}:V=="to"&&(s.value.warehouse_target={...r}),x.value=!1},m=async()=>{Y().loading_full=!0,v.value={};let r={type:s.value.type,note:s.value.note,warehouse_id:s.value.warehouse.id,warehouse_target_id:s.value.warehouse_target.id,details:JSON.stringify(I.value)},l="post",j=d.query.id;j===""||(l="put",r.id=j);const{data:z,error:P,status:se}=await ce("/api/transaction",{method:l,headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:r,retry:0});if(Y().loading_full=!1,se.value==="error"){ue().trigger(P,v);return}u.go(-1)},h=ge(()=>{var r,l;return((r=s.value.warehouse)==null?void 0:r.id)||((l=s.value.warehouse_target)==null?void 0:l.id)||0}),T=_(-1),G=_(!1),ie=_({left:0,top:0}),g=(r,l)=>{T.value=l,G.value=!0,ie.value={left:r.clientX,top:r.clientY}},X=()=>{I.value.push({...L.value,status:"Add"})},_e=()=>{G.value=!1},qe=(r="")=>{if(r=="insert")I.value.splice(T.value,0,{...L.value,status:"Add"});else if(r=="delete"){let l=I.value[T.value].item.id,j=i.value.indexOf(l);j>-1&&i.value.splice(j,1),I.value[T.value].status=="Edit"?I.value[T.value].status="Remove":I.value.splice(T.value,1)}G.value=!1},k=ge(()=>s.value.confirmed_by||s.value.ref_id!=null);return(r,l)=>{const j=Oe,z=pe,P=Re,se=Ge,fe=Me,K=Ke,je=We,De=Wt,Le=hs,Ne=ys;return o(),a(J,null,[e("div",xs,[S(j,{title:"Form Transaksi",back:!0}),e("form",bs,[e("div",gs,[e("div",ks,[t(s).confirmed_by?(o(),a("div",$s,[Ss,e("div",Cs,f(r.$moment(t(s).input_at).format("DD-MM-Y")),1)])):$("",!0),e("div",Is,[Ms,O(e("select",{disabled:t(k),class:"","onUpdate:modelValue":l[0]||(l[0]=p=>t(s).type=p)},Ds,8,As),[[ae,t(s).type]]),e("p",Ls,f(t(v).type),1)]),e("div",Ns,[Os,e("div",Rs,[!t(s).warehouse||!t(s).warehouse.id?(o(),a("div",Fs,[e("button",{type:"button",onClick:l[1]||(l[1]=p=>b("from")),class:"flex items-center grow"},[S(z,{class:"text-2xl text-black"}),Bs])])):t(s).ref_id==null?(o(),a("div",{key:1,class:E(["w-full flex",t(k)?"unselectable":""]),style:{}},[e("div",Vs,[e("div",Hs,[Us,e("div",zs,f(t(s).warehouse.id),1)]),e("div",Ps,[Ks,e("div",Ws,f(t(s).warehouse.name),1)])]),t(k)?$("",!0):(o(),a("button",{key:0,type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:l[2]||(l[2]=p=>Q("from"))},[S(P,{class:"text-2xl text-white"})]))],2)):t(s).ref_id!=null?(o(),a("div",{key:2,class:E(["w-full flex",t(k)?"unselectable":""]),style:{}},[e("div",Es,[e("div",Ys,[Js,e("div",Qs,f(t(s).warehouse_source.id),1)]),e("div",Zs,[Gs,e("div",Xs,f(t(s).warehouse_source.name),1)])]),t(k)?$("",!0):(o(),a("button",{key:0,type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:l[3]||(l[3]=p=>Q("from"))},[S(P,{class:"text-2xl text-white"})]))],2)):$("",!0)]),e("p",el,f(t(v).warehouse_id),1)]),t(s).type=="transfer"?(o(),a("div",tl,[sl,e("div",ll,[!t(s).warehouse_target||!t(s).warehouse_target.id?(o(),a("div",ol,[e("button",{type:"button",onClick:l[4]||(l[4]=p=>b("to")),class:"flex items-center grow"},[S(z,{class:"text-2xl text-black"}),al])])):(o(),a("div",{key:1,class:E(["w-full flex",t(k)?"unselectable":""]),style:{}},[e("div",nl,[e("div",il,[rl,e("div",ul,f(t(s).warehouse_target.id),1)]),e("div",cl,[dl,e("div",_l,f(t(s).warehouse_target.name),1)])]),t(k)?$("",!0):(o(),a("button",{key:0,type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:l[5]||(l[5]=p=>Q("to"))},[S(P,{class:"text-2xl text-white"})]))],2))]),e("p",fl,f(t(v).warehouse_target_id),1)])):$("",!0),e("div",pl,[ml,O(e("textarea",{disabled:t(k),class:"","onUpdate:modelValue":l[6]||(l[6]=p=>t(s).note=p)},null,8,vl),[[re,t(s).note]]),e("p",hl,f(t(v).note),1)])]),e("div",wl,[e("div",yl,[e("table",xl,[e("thead",null,[e("tr",bl,[t(k)?$("",!0):(o(),a("th",gl,[e("button",{type:"button",name:"button",class:"bg-yellow-600",onClick:l[7]||(l[7]=p=>te())}," Bulk Add ")])),kl,t(k)?$("",!0):(o(),a("th",$l)),Sl,Cl,Il,Ml,Al])]),e("tbody",null,[(o(!0),a(J,null,oe(t(I),(p,Z)=>(o(),a(J,{key:Z},[p.status!="Remove"?(o(),a("tr",Tl,[t(k)?$("",!0):(o(),a("td",ql,[e("div",jl,[e("button",{type:"button",name:"button",onClick:F=>g(F,Z)},[S(se)],8,Dl)])])),e("td",null,f(Z+1)+".",1),t(k)?$("",!0):(o(),a("td",Ll,[e("div",Nl,[p.item_id?(o(),a("button",{key:1,type:"button",onClick:F=>A(F,Z),disabled:p.confirm_by},[S(fe,{class:"font-bold text-2xl"})],8,Rl)):(o(),a("button",{key:0,type:"button",name:"button",onClick:F=>U(F,Z)}," ... ",8,Ol))])])),e("td",{class:E(["cell bold",t(k)?"unselectable":""])},[e("div",Fl,f(p.item.id),1)],2),e("td",{class:E(["cell",t(k)?"unselectable":""])},[e("div",Bl,f(p.item.name),1)],2),e("td",Vl,[e("div",Hl,[(o(),ke(K,{disabled:t(k)||t(s).type=="used"||t(s).type=="transfer",key:Z,class:"w-full h-full border-black border-solid border-1 p-1",type:"text",value:p.qty_in||0,onInput:F=>p.qty_in=F},null,8,["disabled","value","onInput"]))])]),e("td",Ul,[e("div",zl,[(o(),ke(K,{disabled:t(k)||t(s).type=="in",key:Z,class:"w-full h-full border-black border-solid border-1 p-1",type:"text",value:p.qty_out||0,onInput:F=>p.qty_out=F},null,8,["disabled","value","onInput"]))])]),e("td",Pl,[e("div",Kl,[O(e("textarea",{disabled:t(k),class:"border-black border-solid border-1 p-1 w-full","onUpdate:modelValue":F=>p.note=F,cols:"7",rows:"2"},null,8,Wl),[[re,p.note]])])])])):$("",!0)],64))),128)),t(k)?$("",!0):(o(),a("tr",El,[e("td",Yl,[e("button",{type:"button",name:"button",onClick:l[8]||(l[8]=p=>X())},[S(je)])])]))])])],512)])]),e("div",Jl,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[9]||(l[9]=p=>r.$router.go(-1))}," Cancel "),t(k)?$("",!0):(o(),a("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[10]||(l[10]=we(p=>m(),["prevent"]))}," Save "))])])]),S(De,{show:t(N),fnClose:ee,fnSelect:H,fnSelectMulti:B,exclude_lists:t(i),enableMultiSelect:t(q),multi_key:["id","name"]},null,8,["show","exclude_lists","enableMultiSelect"]),S(Le,{show:t(x),fnClose:R,fnSelect:ne,opt:t(V),exclude:t(h)},null,8,["show","opt","exclude"]),S(Ne,{show:t(G),coor:t(ie),fn:_e,onReplyAct:l[11]||(l[11]=p=>qe(p))},null,8,["show","coor"])],64)}}});export{io as default};
