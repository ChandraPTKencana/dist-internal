import{_ as O}from"./Header.cca1e452.js";import{_ as P}from"./Plus.0d48322c.js";import{_ as Y}from"./Edit.e31c6ac9.js";import{_ as Z}from"./Search.0b0b0847.js";import{h as K,k as J,r as p,i as Q,y as M,z as G,c as m,b as v,a as e,m as D,v as W,n as a,A as X,B,F as ee,C as te,l as le,o as h,D as se,t as _,p as oe,e as ae,E as re,q as x,s as H,x as I}from"./entry.bd9ce3f6.js";import{u as ne}from"./useUtils.70251168.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";const n=b=>(oe("data-v-86e917c6"),b=b(),ae(),b),ue={class:"w-full h-full flex flex-col"},de={class:"w-full flex grow flex-col overflow-auto h-0"},ce={class:"w-full flex"},_e={class:"w-full flex p-1"},fe={class:"grow"},pe=n(()=>e("div",{class:"font-bold"}," Keyword ",-1)),me={class:"pl-1"},ve=n(()=>e("div",{class:"font-bold"}," Sort By ",-1)),he=n(()=>e("option",{value:""},null,-1)),be=n(()=>e("option",{value:"email"},"Email",-1)),ge=n(()=>e("option",{value:"fullname"},"Fullname",-1)),ye=[he,be,ge],ke={class:"pl-1"},xe=n(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),we=n(()=>e("option",{value:"asc"},"Asc",-1)),De=n(()=>e("option",{value:"desc"},"Desc",-1)),Se=[we,De],$e={class:"flex items-end pl-1"},Ae={class:"w-full flex justify-center items-center grow h-0 p-1"},Te={key:0,class:""},Ce={class:"tacky"},Le=n(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Email"),e("th",null,"Fullname"),e("th",null,"Role"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),Me=["onClick"],Be={class:"bold"},He={__name:"index",async setup(b){let g,S;const{$moment:$}=re(),{sayHello:F}=ne();F();const r={};r._TimeZoneOffset=new Date().getTimezoneOffset();const A=K("token"),{data:i}=([g,S]=J(async()=>le(async()=>{x().loading_full=!0;const{data:o,error:t,status:f}=await H("/api/users",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:r,retry:0},"$LZQttUfkIg");return x().loading_full=!1,f.value==="error"?(I().trigger(t),[]):o.value.data},"$4SJ9UL5Y8i")),g=await g,S(),g),u=p(""),d=p({field:"",by:"desc"}),c=p(-1),s=p({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),R=()=>{r.like="",u.value!=""&&(r.like=`id:%${u.value}%,email:%${u.value}%,fullname:%${u.value}%`),r.sort="",d.value.field&&(r.sort=d.value.field+":"+d.value.by)},y=p(null),T=async()=>{x().loading_full=!0,s.value.may_get_data=!1,r.page=s.value.page,r.page==1&&(i.value=[]);const{data:o,error:t,status:f}=await H("/api/users",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:r,retry:0},"$TB7ZAgqAgs");if(x().loading_full=!1,s.value.may_get_data=!0,f.value==="error"){I().trigger(t);return}s.value.page==1?(i.value=o.value.data,y.value&&(y.value.scrollTop=0)):s.value.page>1&&(i.value=[...i.value,...o.value.data]),o.value.data.length==0&&(s.value.is_last_record=!0)},U=async()=>{if(!s.value.may_get_data)return;let o=y.value;if(o.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=o.scrollLeft;return}s.value.is_last_record||!(Math.round(o.scrollTop)+o.clientHeight>=o.scrollHeight-1)||(s.value.page++,await T())},z=()=>{s.value.page=1,s.value.is_last_record=!1,R(),T()},w=Q(),E=()=>{w.push({name:"user-form",query:{id:""}})},{display:C}=M();G(M());const q=()=>{c.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):w.push({name:"user-form",query:{id:i.value[c.value].id}})},V=()=>{c.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):w.push({name:"user-permission",query:{id:i.value[c.value].id}})};return(o,t)=>{const f=O,j=P,L=Y,N=Z;return h(),m("div",ue,[v(f,{title:"List User"}),e("div",de,[e("div",ce,[e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[0]||(t[0]=l=>E())},[v(j)]),e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[1]||(t[1]=l=>q())},[v(L)]),e("button",{type:"button",name:"button",class:"border-black border-solid border-2 p-1 m-1 text-2xl",onClick:t[2]||(t[2]=l=>V())},[v(L)])]),e("div",_e,[e("div",fe,[pe,D(e("input",{class:"w-full border-black border-solid border-2 p-1",type:"text","onUpdate:modelValue":t[3]||(t[3]=l=>X(u)?u.value=l:null),name:"search",placeholder:"Keyword"},null,512),[[W,a(u)]])]),e("div",me,[ve,D(e("select",{class:"w-full border-black border-solid border-2 p-1","onUpdate:modelValue":t[4]||(t[4]=l=>a(d).field=l)},ye,512),[[B,a(d).field]])]),e("div",ke,[xe,D(e("select",{class:"w-full border-black border-solid border-2 p-1","onUpdate:modelValue":t[5]||(t[5]=l=>a(d).by=l)},Se,512),[[B,a(d).by]])]),e("div",$e,[e("button",{class:"w-full border-black border-solid border-2 p-1",type:"button",name:"button",onClick:t[6]||(t[6]=l=>z())},[v(N,{class:"text-2xl"})])])]),e("div",Ae,[a(i).length==0?(h(),m("div",Te," Maaf Tidak Ada Record ")):(h(),m("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:y,onScroll:U},[e("table",Ce,[Le,e("tbody",null,[(h(!0),m(ee,null,te(a(i),(l,k)=>(h(),m("tr",{key:k,onClick:Ie=>c.value=k,class:se(a(c)==k?"active":"")},[e("td",null,_(k+1)+".",1),e("td",Be,_(l.email),1),e("td",null,_(l.fullname),1),e("td",null,_(l.role),1),e("td",null,_(a($)(l.internal_created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,_(a($)(l.internal_updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Me))),128))])])],544))])])])}}},je=ie(He,[["__scopeId","data-v-86e917c6"]]);export{je as default};
