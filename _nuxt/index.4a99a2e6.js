import te from"./Header.ec2830b8.js";import ae from"./Edit.e3c2c2a7.js";import se from"./TableView.27e3590f.js";import{_ as oe}from"./PopupMini.vue.740d533e.js";import le from"./user.a9e58e4b.js";import{_ as re}from"./GAQR.vue.afd98e6a.js";import{r as a,f as ne,g as ie,h as ue,i as m,j,s as de,c as E,a as _,b as p,k as _e,v as ce,l as s,m as fe,n as pe,w as F,F as me,q as ve,x as d,y as C,o as P,d as I,t as V,p as ge,e as ye}from"./entry.468c1924.js";import{u as A}from"./useMyFetch.5d39e20e.js";import{u as h}from"./useUtils.f67a7b52.js";import{_ as he}from"./_plugin-vue_export-helper.c27b6911.js";import"./Search.9b037104.js";import"./Adjust.cf28fd93.js";import"./TableHeaderEye.7cf37920.js";import"./Times.725e6b46.js";import"./ClearAll.34ea9b9e.js";import"./client-only.22df5fad.js";import"./ClearEach.6936ca01.js";import"./CaretLeftDoubleBold.3206de64.js";import"./CaretLeftBold.d337aee3.js";import"./CaretRightBold.65e7ac4a.js";import"./CaretRightDoubleBold.10274d1d.js";import"./Exclamation.b8184944.js";import"./HeaderPopup.vue.fe14bc58.js";const D=v=>(ge("data-v-ce03f337"),v=v(),ye(),v),we={class:"w-full h-full flex flex-col"},xe={class:"w-full flex grow flex-col overflow-auto h-0"},ke={class:"w-full flex justify-between flex-wrap"},be={class:"grow flex"},Se={class:"m-1"},Ce=D(()=>_("option",{value:"active"},"Active",-1)),Ae=D(()=>_("option",{value:"nonactive"},"Nonactive",-1)),De=D(()=>_("option",{value:"all"},"All",-1)),$e=[Ce,Ae,De],Be={__name:"index",async setup(v){let g,$;const q=e=>e.is_active==0?"!bg-red-400":"",c=a("active");ne(()=>c.value,e=>{N()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset();const w=ie("token"),{data:l}=([g,$]=ue(async()=>ve(async()=>{d().loading_full=!0;const{data:e,error:t,status:u}=await A("/api/users",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{filter_status:c},retry:0});return d().loading_full=!1,u.value==="error"?(C().trigger(t),[]):e.value.data},"$4SJ9UL5Y8i")),g=await g,$(),g);a("");const x=a({field:"",by:"desc"}),o=a(-1),i=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),k=m(()=>l.value[o.value]),z=()=>{n.like="";let e=JSON.parse(JSON.stringify(d()._tv.global_keyword));e!=""&&(n.like=`id:%${e}%,username:%${e}%`),n.sort="",x.value.field&&(n.sort=x.value.field+":"+x.value.by),n.filter_model=JSON.stringify(d()._tv.filter_model)},J=e=>{let t=[];return e.permission_group_users&&e.permission_group_users.length>0&&e.permission_group_users.forEach(u=>{t.push(u.permission_group.name)}),t.join(",")};a(null);const B=async()=>{d().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(l.value=[]),n.filter_status=c.value;const{data:e,error:t,status:u}=await A("/api/users",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:n,retry:0});if(d().loading_full=!1,i.value.may_get_data=!0,u.value==="error"){C().trigger(t);return}i.value.page==1?l.value=e.value.data:i.value.page>1&&(l.value=[...l.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0),d()._tv.filter_box=!1},N=()=>{o.value=-1,i.value.page=1,i.value.is_last_record=!1,z(),B()},b=a(!1),O=a(0),T=a(0),L=a(!1),{display:M}=j();de(j());const R=()=>{o.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=l.value[o.value].id,L.value=!1,T.value=!1,b.value=!0)},G=a({}),y=a(!1),H=async()=>{y.value&&(y.value=!1)},Q=async()=>{d().loading_full=!0;const e=new FormData;e.append("id",l.value[o.value].id),e.append("_method","DELETE");const{data:t,error:u,status:S}=await A("/api/user",{method:"post",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:e,retry:0});if(d().loading_full=!1,S.value==="error"){C().trigger(u);return}let f={...l.value[o.value]};f.deleted=t.value.deleted,f.deleted_user=t.value.deleted_user,f.deleted_at=t.value.deleted_at,f.deleted_by=t.value.deleted_by,f.deleted_reason=t.value.deleted_reason,c.value!="all"?l.value.splice(o.value,1):l.value.splice(o.value,1,{...f}),o.value=-1,y.value=!1},Y=a(""),U=a(!1),Z=a([{key:"no",label:"No",isai:!0},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"username",label:"Username",freeze:1,filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"group",label:"Group",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"select",select_item:[{k:"1",v:"aktif"},{k:"0",v:"blokir"}]}]);m(()=>o.value>-1&&[void 0,0].indexOf(k.value.deleted)>-1&&h().checkPermission("user.create")),m(()=>["active","nonactive","all"].indexOf(c.value)>-1&&h().checkPermission("user.create"));const K=m(()=>o.value>-1&&[void 0,0].indexOf(k.value.deleted)>-1&&h().checkPermissions(["user.modify"]));return m(()=>o.value>-1&&h().checkPermission("user.remove")&&[void 0,0].indexOf(k.value.deleted)>-1),(e,t)=>{const u=te,S=ae,f=se,W=oe,X=le,ee=re;return P(),E(me,null,[_("div",we,[p(u,{title:"List User"}),_("div",xe,[_("div",ke,[_("div",be,[_("div",Se,[_e(_("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=r=>fe(c)?c.value=r:null)},$e,512),[[ce,s(c)]])]),s(K)?(P(),E("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=r=>R())},[p(S)])):pe("",!0)])]),p(f,{thead:s(Z),selected:s(o),onSetSelected:t[2]||(t[2]=r=>o.value=r),tbody:s(l),fnCallData:B,scrolling:s(i),onSetScrollingPage:t[3]||(t[3]=r=>s(i).page=r),onDoFilter:t[4]||(t[4]=r=>N()),rowBgColor:q},{group:F(({item:r})=>[I(V(J(r)),1)]),is_active:F(({item:r})=>[I(V(r.is_active==1?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["thead","selected","tbody","scrolling"])])]),p(W,{type:"delete",show:s(y),data:s(G),fnClose:H,fnConfirm:Q},null,8,["show","data"]),p(X,{show:s(b),fnClose:()=>{b.value=!1},id:s(O),p_data:s(l),is_copy:s(T)},null,8,["show","fnClose","id","p_data","is_copy"]),p(ee,{show:s(U),fnClose:()=>{U.value=!1},qrCodeUrl:s(Y)},null,8,["show","fnClose","qrCodeUrl"])],64)}}},Xe=he(Be,[["__scopeId","data-v-ce03f337"]]);export{Xe as default};
