import{_ as q}from"./HeaderPopup.vue.01948059.js";import E from"./Search.dc4ae93e.js";import{g as I,r as f,f as K,k as g,J as N,o as p,c as v,a as e,b as M,m as R,A as j,l as n,v as $,F as z,D as O,E as J,t as _,G as Y,p as G,e as P,x as A,y as Z}from"./entry.622940e4.js";import{u as Q}from"./useUtils.3d22bd33.js";import{u as W}from"./useMyFetch.83f6fc10.js";import{_ as X}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.4935bce4.js";const r=u=>(G("data-v-f09d932a"),u=u(),P(),u),ee={class:"box-fixed"},te={class:"w-full flex p-1"},le={class:"grow"},se=r(()=>e("div",{class:"font-bold"}," Keyword ",-1)),ae={class:"pl-1"},oe=r(()=>e("div",{class:"font-bold"}," Sort By ",-1)),ne=r(()=>e("option",{value:"created_at"},"Created At",-1)),re=r(()=>e("option",{value:"username"},"Username",-1)),ie=r(()=>e("option",{value:"email"},"Email",-1)),ue=r(()=>e("option",{value:"fullname"},"Fullname",-1)),ce=[ne,re,ie,ue],de={class:"pl-1"},fe=r(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),_e=r(()=>e("option",{value:"asc"},"Asc",-1)),me=r(()=>e("option",{value:"desc"},"Desc",-1)),pe=[_e,me],ve={class:"flex items-end pl-1"},he={class:"w-full flex justify-center items-center grow h-0 p-1"},ye={key:0,class:""},ge={class:"tacky"},we=r(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Username"),e("th",null,"Email"),e("th",null,"Fullname"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),ke=["onClick"],be={class:"bold"},Se={class:"flex",style:{"justify-content":"end",padding:"5px"}},xe={__name:"members",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1}},setup(u){const w=u,{$moment:x}=Y(),{countClickListFn:F}=Q(),H=I("token"),i=f([]),c=f(""),d=f({field:"created_at",by:"desc"}),h=f(-1),s=f({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),o={};o._TimeZoneOffset=new Date().getTimezoneOffset();const L=()=>{o.like="",c.value!=""&&(o.like=`username:%${c.value}%,email:%${c.value}%,fullname:%${c.value}%`),o.sort="",d.value.field&&(o.sort=d.value.field+":"+d.value.by)},y=f(null),D=async()=>{A().loading_full=!0,s.value.may_get_data=!1,o.page=s.value.page,o.page==1&&(i.value=[]),o.first_row&&delete o.first_row,o.page>1&&(o.first_row=JSON.stringify(i.value[0]));const{data:a,error:t,status:S}=await W("/api/members",{method:"get",headers:{Authorization:`Bearer ${H.value}`,Accept:"application/json"},params:o,retry:0});if(A().loading_full=!1,s.value.may_get_data=!0,S.value==="error"){Z().trigger(t);return}s.value.page==1?(i.value=a.value.data,y.value&&(y.value.scrollTop=0)):s.value.page>1&&(i.value=[...i.value,...a.value.data]),a.value.data.length==0&&(s.value.is_last_record=!0)},B=async()=>{if(!s.value.may_get_data)return;let a=y.value;if(a.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=a.scrollLeft;return}s.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(s.value.page++,await D())},k=()=>{s.value.page=1,s.value.is_last_record=!1,L(),D()},T=()=>{h.value>-1?w.fnSelect(i.value[h.value]):w.fnSelect({id:"",username:"",email:"",fullname:""})},C=f(null);let b=null;const U=a=>{b&&clearTimeout(b),b=setTimeout(()=>{k()},500)};return K(()=>w.show,(a,t)=>{a==!0&&k(),setTimeout(()=>{C.value.focus()},100)},{immediate:!0}),(a,t)=>{const S=q,V=E;return g((p(),v("section",ee,[e("div",null,[M(S,{title:"Search And Select Members",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("div",te,[e("div",le,[se,g(e("input",{ref_key:"ref_keyword",ref:C,class:"",type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>R(c)?c.value=l:null),name:"search",placeholder:"Keyword",onKeyup:t[1]||(t[1]=l=>U())},null,544),[[j,n(c)]])]),e("div",ae,[oe,g(e("select",{class:"","onUpdate:modelValue":t[2]||(t[2]=l=>n(d).field=l)},ce,512),[[$,n(d).field]])]),e("div",de,[fe,g(e("select",{class:"","onUpdate:modelValue":t[3]||(t[3]=l=>n(d).by=l)},pe,512),[[$,n(d).by]])]),e("div",ve,[e("button",{class:"",type:"button",name:"button",onClick:t[4]||(t[4]=l=>k())},[M(V,{class:"text-2xl"})])])]),e("div",he,[n(i).length==0?(p(),v("div",ye," Maaf Tidak Ada Record ")):(p(),v("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:y,onScroll:B},[e("table",ge,[we,e("tbody",null,[(p(!0),v(z,null,O(n(i),(l,m)=>(p(),v("tr",{key:m,onClick:De=>n(F)(m,()=>{h.value=m},T),class:J(n(h)==m?"active":"")},[e("td",null,_(m+1)+".",1),e("td",be,_(l.username),1),e("td",null,_(l.email),1),e("td",null,_(l.fullname),1),e("td",null,_(n(x)(l.internal_created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,_(n(x)(l.internal_updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,ke))),128))])])],544))]),e("div",Se,[e("button",{onClick:t[5]||(t[5]=l=>T()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[N,u.show]])}}},Le=X(xe,[["__scopeId","data-v-f09d932a"]]);export{Le as default};
